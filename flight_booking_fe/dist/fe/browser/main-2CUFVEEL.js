import{a as It,b as Wn}from"./chunk-D6M4USHK.js";import{a as dt,b as Ge,c as Hn}from"./chunk-JHNWM6FA.js";import{$ as Cn,$a as Te,$b as Ve,Aa as b,Ab as Vn,B as Z,Ba as p,Bb as X,C as Me,Ca as kn,Cb as Ln,D as J,Da as Tn,Eb as Lt,F as j,G as ni,Gb as me,Hb as w,I as z,Ia as Ri,Ib as de,Ja as En,Jb as pe,K as q,Ka as et,L as ri,La as l,M as yn,Ma as N,Mb as ue,N as oi,Na as x,Nb as he,Oa as bt,Ob as jn,Pb as Un,Q as F,Qb as fe,R as D,Rb as kt,Sb as Tt,Ta as Se,Tb as Et,U as xn,Ua as In,Ub as We,Va as Ct,Vb as ge,W as lt,Wa as tt,Wb as qn,X as xt,Xa as Vt,Xb as Be,Y as bn,Yb as $e,Z as Di,Zb as se,_ as Ze,_a as ke,a as ti,aa as wn,ac as Yn,b as cn,ba as c,bb as ct,bc as Pi,c as Fi,ca as T,cb as Fn,cc as Ni,d as to,e as ii,ea as ae,f as mn,fa as Mi,fb as Dn,fc as zn,g as ne,gb as mt,h as dn,hb as Pe,ia as g,ib as re,ic as ai,jb as Mn,jc as Gn,ka as d,kb as An,kc as Jn,ma as Ai,mb as si,n as we,na as Sn,o as yt,oa as Q,ob as Rn,p as Qe,pa as je,pb as Ee,qa as _t,qb as On,r as pn,ra as le,s as un,sa as ce,sb as Oi,t as De,ta as a,tb as Ne,u as Le,ua as s,ub as wt,v as hn,va as S,vb as Pn,w as fn,wb as Nn,x as gn,xb as Bn,y as _n,ya as ze,yb as $n,z as vn,za as V,zb as St}from"./chunk-BSEN6LWU.js";var en=Fi((Qi,Zi)=>{"use strict";(function(t,n){typeof Qi=="object"&&typeof Zi<"u"?Zi.exports=n():typeof define=="function"&&define.amd?define(n):(t=typeof globalThis<"u"?globalThis:t||self).dayjs=n()})(Qi,function(){"use strict";var t=1e3,n=6e4,e=36e5,i="millisecond",r="second",o="minute",m="hour",u="day",h="week",_="month",C="quarter",L="year",ee="date",ot="Invalid Date",M=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,$=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,H={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(E){var v=["th","st","nd","rd"],f=E%100;return"["+E+(v[(f-20)%10]||v[f]||v[0])+"]"}},U=function(E,v,f){var k=String(E);return!k||k.length>=v?E:""+Array(v+1-k.length).join(f)+E},Ie={s:U,z:function(E){var v=-E.utcOffset(),f=Math.abs(v),k=Math.floor(f/60),y=f%60;return(v<=0?"+":"-")+U(k,2,"0")+":"+U(y,2,"0")},m:function E(v,f){if(v.date()<f.date())return-E(f,v);var k=12*(f.year()-v.year())+(f.month()-v.month()),y=v.clone().add(k,_),I=f-y<0,A=v.clone().add(k+(I?-1:1),_);return+(-(k+(f-y)/(I?y-A:A-y))||0)},a:function(E){return E<0?Math.ceil(E)||0:Math.floor(E)},p:function(E){return{M:_,y:L,w:h,d:u,D:ee,h:m,m:o,s:r,ms:i,Q:C}[E]||String(E||"").toLowerCase().replace(/s$/,"")},u:function(E){return E===void 0}},te="en",_e={};_e[te]=H;var He="$isDayjsObject",Fe=function(E){return E instanceof ve||!(!E||!E[He])},xe=function E(v,f,k){var y;if(!v)return te;if(typeof v=="string"){var I=v.toLowerCase();_e[I]&&(y=I),f&&(_e[I]=f,y=I);var A=v.split("-");if(!y&&A.length>1)return E(A[0])}else{var R=v.name;_e[R]=v,y=R}return!k&&y&&(te=y),y||!k&&te},Y=function(E,v){if(Fe(E))return E.clone();var f=typeof v=="object"?v:{};return f.date=E,f.args=arguments,new ve(f)},O=Ie;O.l=xe,O.i=Fe,O.w=function(E,v){return Y(E,{locale:v.$L,utc:v.$u,x:v.$x,$offset:v.$offset})};var ve=function(){function E(f){this.$L=xe(f.locale,null,!0),this.parse(f),this.$x=this.$x||f.x||{},this[He]=!0}var v=E.prototype;return v.parse=function(f){this.$d=function(k){var y=k.date,I=k.utc;if(y===null)return new Date(NaN);if(O.u(y))return new Date;if(y instanceof Date)return new Date(y);if(typeof y=="string"&&!/Z$/i.test(y)){var A=y.match(M);if(A){var R=A[2]-1||0,G=(A[7]||"0").substring(0,3);return I?new Date(Date.UTC(A[1],R,A[3]||1,A[4]||0,A[5]||0,A[6]||0,G)):new Date(A[1],R,A[3]||1,A[4]||0,A[5]||0,A[6]||0,G)}}return new Date(y)}(f),this.init()},v.init=function(){var f=this.$d;this.$y=f.getFullYear(),this.$M=f.getMonth(),this.$D=f.getDate(),this.$W=f.getDay(),this.$H=f.getHours(),this.$m=f.getMinutes(),this.$s=f.getSeconds(),this.$ms=f.getMilliseconds()},v.$utils=function(){return O},v.isValid=function(){return this.$d.toString()!==ot},v.isSame=function(f,k){var y=Y(f);return this.startOf(k)<=y&&y<=this.endOf(k)},v.isAfter=function(f,k){return Y(f)<this.startOf(k)},v.isBefore=function(f,k){return this.endOf(k)<Y(f)},v.$g=function(f,k,y){return O.u(f)?this[k]:this.set(y,f)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(f,k){var y=this,I=!!O.u(k)||k,A=O.p(f),R=function(Ye,oe){var Oe=O.w(y.$u?Date.UTC(y.$y,oe,Ye):new Date(y.$y,oe,Ye),y);return I?Oe:Oe.endOf(u)},G=function(Ye,oe){return O.w(y.toDate()[Ye].apply(y.toDate("s"),(I?[0,0,0,0]:[23,59,59,999]).slice(oe)),y)},K=this.$W,ie=this.$M,Ce=this.$D,st="set"+(this.$u?"UTC":"");switch(A){case L:return I?R(1,0):R(31,11);case _:return I?R(1,ie):R(0,ie+1);case h:var Ke=this.$locale().weekStart||0,gt=(K<Ke?K+7:K)-Ke;return R(I?Ce-gt:Ce+(6-gt),ie);case u:case ee:return G(st+"Hours",0);case m:return G(st+"Minutes",1);case o:return G(st+"Seconds",2);case r:return G(st+"Milliseconds",3);default:return this.clone()}},v.endOf=function(f){return this.startOf(f,!1)},v.$set=function(f,k){var y,I=O.p(f),A="set"+(this.$u?"UTC":""),R=(y={},y[u]=A+"Date",y[ee]=A+"Date",y[_]=A+"Month",y[L]=A+"FullYear",y[m]=A+"Hours",y[o]=A+"Minutes",y[r]=A+"Seconds",y[i]=A+"Milliseconds",y)[I],G=I===u?this.$D+(k-this.$W):k;if(I===_||I===L){var K=this.clone().set(ee,1);K.$d[R](G),K.init(),this.$d=K.set(ee,Math.min(this.$D,K.daysInMonth())).$d}else R&&this.$d[R](G);return this.init(),this},v.set=function(f,k){return this.clone().$set(f,k)},v.get=function(f){return this[O.p(f)]()},v.add=function(f,k){var y,I=this;f=Number(f);var A=O.p(k),R=function(ie){var Ce=Y(I);return O.w(Ce.date(Ce.date()+Math.round(ie*f)),I)};if(A===_)return this.set(_,this.$M+f);if(A===L)return this.set(L,this.$y+f);if(A===u)return R(1);if(A===h)return R(7);var G=(y={},y[o]=n,y[m]=e,y[r]=t,y)[A]||1,K=this.$d.getTime()+f*G;return O.w(K,this)},v.subtract=function(f,k){return this.add(-1*f,k)},v.format=function(f){var k=this,y=this.$locale();if(!this.isValid())return y.invalidDate||ot;var I=f||"YYYY-MM-DDTHH:mm:ssZ",A=O.z(this),R=this.$H,G=this.$m,K=this.$M,ie=y.weekdays,Ce=y.months,st=y.meridiem,Ke=function(oe,Oe,Xe,at){return oe&&(oe[Oe]||oe(k,I))||Xe[Oe].slice(0,at)},gt=function(oe){return O.s(R%12||12,oe,"0")},Ye=st||function(oe,Oe,Xe){var at=oe<12?"AM":"PM";return Xe?at.toLowerCase():at};return I.replace($,function(oe,Oe){return Oe||function(Xe){switch(Xe){case"YY":return String(k.$y).slice(-2);case"YYYY":return O.s(k.$y,4,"0");case"M":return K+1;case"MM":return O.s(K+1,2,"0");case"MMM":return Ke(y.monthsShort,K,Ce,3);case"MMMM":return Ke(Ce,K);case"D":return k.$D;case"DD":return O.s(k.$D,2,"0");case"d":return String(k.$W);case"dd":return Ke(y.weekdaysMin,k.$W,ie,2);case"ddd":return Ke(y.weekdaysShort,k.$W,ie,3);case"dddd":return ie[k.$W];case"H":return String(R);case"HH":return O.s(R,2,"0");case"h":return gt(1);case"hh":return gt(2);case"a":return Ye(R,G,!0);case"A":return Ye(R,G,!1);case"m":return String(G);case"mm":return O.s(G,2,"0");case"s":return String(k.$s);case"ss":return O.s(k.$s,2,"0");case"SSS":return O.s(k.$ms,3,"0");case"Z":return A}return null}(oe)||A.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(f,k,y){var I,A=this,R=O.p(k),G=Y(f),K=(G.utcOffset()-this.utcOffset())*n,ie=this-G,Ce=function(){return O.m(A,G)};switch(R){case L:I=Ce()/12;break;case _:I=Ce();break;case C:I=Ce()/3;break;case h:I=(ie-K)/6048e5;break;case u:I=(ie-K)/864e5;break;case m:I=ie/e;break;case o:I=ie/n;break;case r:I=ie/t;break;default:I=ie}return y?I:O.a(I)},v.daysInMonth=function(){return this.endOf(_).$D},v.$locale=function(){return _e[this.$L]},v.locale=function(f,k){if(!f)return this.$L;var y=this.clone(),I=xe(f,k,!0);return I&&(y.$L=I),y},v.clone=function(){return O.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},E}(),be=ve.prototype;return Y.prototype=be,[["$ms",i],["$s",r],["$m",o],["$H",m],["$W",u],["$M",_],["$y",L],["$D",ee]].forEach(function(E){be[E[1]]=function(v){return this.$g(v,E[0],E[1])}}),Y.extend=function(E,v){return E.$i||(E(v,ve,Y),E.$i=!0),Y},Y.locale=xe,Y.isDayjs=Fe,Y.unix=function(E){return Y(1e3*E)},Y.en=_e[te],Y.Ls=_e,Y.p={},Y})});var Dr=Fi((tn,nn)=>{"use strict";(function(t,n){typeof tn=="object"&&typeof nn<"u"?nn.exports=n():typeof define=="function"&&define.amd?define(n):(t=typeof globalThis<"u"?globalThis:t||self).dayjs_plugin_localeData=n()})(tn,function(){"use strict";return function(t,n,e){var i=n.prototype,r=function(_){return _&&(_.indexOf?_:_.s)},o=function(_,C,L,ee,ot){var M=_.name?_:_.$locale(),$=r(M[C]),H=r(M[L]),U=$||H.map(function(te){return te.slice(0,ee)});if(!ot)return U;var Ie=M.weekStart;return U.map(function(te,_e){return U[(_e+(Ie||0))%7]})},m=function(){return e.Ls[e.locale()]},u=function(_,C){return _.formats[C]||function(L){return L.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(ee,ot,M){return ot||M.slice(1)})}(_.formats[C.toUpperCase()])},h=function(){var _=this;return{months:function(C){return C?C.format("MMMM"):o(_,"months")},monthsShort:function(C){return C?C.format("MMM"):o(_,"monthsShort","months",3)},firstDayOfWeek:function(){return _.$locale().weekStart||0},weekdays:function(C){return C?C.format("dddd"):o(_,"weekdays")},weekdaysMin:function(C){return C?C.format("dd"):o(_,"weekdaysMin","weekdays",2)},weekdaysShort:function(C){return C?C.format("ddd"):o(_,"weekdaysShort","weekdays",3)},longDateFormat:function(C){return u(_.$locale(),C)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return h.bind(this)()},e.localeData=function(){var _=m();return{firstDayOfWeek:function(){return _.weekStart||0},weekdays:function(){return e.weekdays()},weekdaysShort:function(){return e.weekdaysShort()},weekdaysMin:function(){return e.weekdaysMin()},months:function(){return e.months()},monthsShort:function(){return e.monthsShort()},longDateFormat:function(C){return u(_,C)},meridiem:_.meridiem,ordinal:_.ordinal}},e.months=function(){return o(m(),"months")},e.monthsShort=function(){return o(m(),"monthsShort","months",3)},e.weekdays=function(_){return o(m(),"weekdays",null,null,_)},e.weekdaysShort=function(_){return o(m(),"weekdaysShort","weekdays",3,_)},e.weekdaysMin=function(_){return o(m(),"weekdaysMin","weekdays",2,_)}}})});var Mr=Fi((rn,on)=>{"use strict";(function(t,n){typeof rn=="object"&&typeof on<"u"?on.exports=n():typeof define=="function"&&define.amd?define(n):(t=typeof globalThis<"u"?globalThis:t||self).dayjs_plugin_customParseFormat=n()})(rn,function(){"use strict";var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,e=/\d/,i=/\d\d/,r=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,m={},u=function(M){return(M=+M)+(M>68?1900:2e3)},h=function(M){return function($){this[M]=+$}},_=[/[+-]\d\d:?(\d\d)?|Z/,function(M){(this.zone||(this.zone={})).offset=function($){if(!$||$==="Z")return 0;var H=$.match(/([+-]|\d\d)/g),U=60*H[1]+(+H[2]||0);return U===0?0:H[0]==="+"?-U:U}(M)}],C=function(M){var $=m[M];return $&&($.indexOf?$:$.s.concat($.f))},L=function(M,$){var H,U=m.meridiem;if(U){for(var Ie=1;Ie<=24;Ie+=1)if(M.indexOf(U(Ie,0,$))>-1){H=Ie>12;break}}else H=M===($?"pm":"PM");return H},ee={A:[o,function(M){this.afternoon=L(M,!1)}],a:[o,function(M){this.afternoon=L(M,!0)}],Q:[e,function(M){this.month=3*(M-1)+1}],S:[e,function(M){this.milliseconds=100*+M}],SS:[i,function(M){this.milliseconds=10*+M}],SSS:[/\d{3}/,function(M){this.milliseconds=+M}],s:[r,h("seconds")],ss:[r,h("seconds")],m:[r,h("minutes")],mm:[r,h("minutes")],H:[r,h("hours")],h:[r,h("hours")],HH:[r,h("hours")],hh:[r,h("hours")],D:[r,h("day")],DD:[i,h("day")],Do:[o,function(M){var $=m.ordinal,H=M.match(/\d+/);if(this.day=H[0],$)for(var U=1;U<=31;U+=1)$(U).replace(/\[|\]/g,"")===M&&(this.day=U)}],w:[r,h("week")],ww:[i,h("week")],M:[r,h("month")],MM:[i,h("month")],MMM:[o,function(M){var $=C("months"),H=(C("monthsShort")||$.map(function(U){return U.slice(0,3)})).indexOf(M)+1;if(H<1)throw new Error;this.month=H%12||H}],MMMM:[o,function(M){var $=C("months").indexOf(M)+1;if($<1)throw new Error;this.month=$%12||$}],Y:[/[+-]?\d+/,h("year")],YY:[i,function(M){this.year=u(M)}],YYYY:[/\d{4}/,h("year")],Z:_,ZZ:_};function ot(M){var $,H;$=M,H=m&&m.formats;for(var U=(M=$.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(Y,O,ve){var be=ve&&ve.toUpperCase();return O||H[ve]||t[ve]||H[be].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(E,v,f){return v||f.slice(1)})})).match(n),Ie=U.length,te=0;te<Ie;te+=1){var _e=U[te],He=ee[_e],Fe=He&&He[0],xe=He&&He[1];U[te]=xe?{regex:Fe,parser:xe}:_e.replace(/^\[|\]$/g,"")}return function(Y){for(var O={},ve=0,be=0;ve<Ie;ve+=1){var E=U[ve];if(typeof E=="string")be+=E.length;else{var v=E.regex,f=E.parser,k=Y.slice(be),y=v.exec(k)[0];f.call(O,y),Y=Y.replace(y,"")}}return function(I){var A=I.afternoon;if(A!==void 0){var R=I.hours;A?R<12&&(I.hours+=12):R===12&&(I.hours=0),delete I.afternoon}}(O),O}}return function(M,$,H){H.p.customParseFormat=!0,M&&M.parseTwoDigitYear&&(u=M.parseTwoDigitYear);var U=$.prototype,Ie=U.parse;U.parse=function(te){var _e=te.date,He=te.utc,Fe=te.args;this.$u=He;var xe=Fe[1];if(typeof xe=="string"){var Y=Fe[2]===!0,O=Fe[3]===!0,ve=Y||O,be=Fe[2];O&&(be=Fe[2]),m=this.$locale(),!Y&&be&&(m=H.Ls[be]),this.$d=function(k,y,I,A){try{if(["x","X"].indexOf(y)>-1)return new Date((y==="X"?1e3:1)*k);var R=ot(y)(k),G=R.year,K=R.month,ie=R.day,Ce=R.hours,st=R.minutes,Ke=R.seconds,gt=R.milliseconds,Ye=R.zone,oe=R.week,Oe=new Date,Xe=ie||(G||K?1:Oe.getDate()),at=G||Oe.getFullYear(),Zt=0;G&&!K||(Zt=K>0?K-1:Oe.getMonth());var ei,ki=Ce||0,Ti=st||0,Ei=Ke||0,Ii=gt||0;return Ye?new Date(Date.UTC(at,Zt,Xe,ki,Ti,Ei,Ii+60*Ye.offset*1e3)):I?new Date(Date.UTC(at,Zt,Xe,ki,Ti,Ei,Ii)):(ei=new Date(at,Zt,Xe,ki,Ti,Ei,Ii),oe&&(ei=A(ei).week(oe).toDate()),ei)}catch{return new Date("")}}(_e,xe,He,H),this.init(),be&&be!==!0&&(this.$L=this.locale(be).$L),ve&&_e!=this.format(xe)&&(this.$d=new Date("")),m={}}else if(xe instanceof Array)for(var E=xe.length,v=1;v<=E;v+=1){Fe[1]=xe[v-1];var f=H.apply(this,Fe);if(f.isValid()){this.$d=f.$d,this.$L=f.$L,this.init();break}v===E&&(this.$d=new Date(""))}else Ie.call(this,te)}}})});function io(t,n){t&1&&(a(0,"span",12),l(1,"*"),s())}function no(t,n){if(t&1&&(a(0,"div",7)(1,"label",8)(2,"span",9),l(3),s(),g(4,io,2,0,"span",10),s(),S(5,"input",11),s()),t&2){let e=p().$implicit;c(3),N(e.value.label),c(),d("ngIf",e.value.required),c(),d("formControlName",e.key)("placeholder",e.value.placeholder)}}function ro(t,n){t&1&&(a(0,"span",12),l(1,"*"),s())}function oo(t,n){if(t&1&&(a(0,"option",16),l(1),s()),t&2){let e=n.$implicit;d("value",e),c(),x(" ",e," ")}}function so(t,n){if(t&1&&(a(0,"div",7)(1,"label",8)(2,"span",9),l(3),s(),g(4,ro,2,0,"span",10),s(),a(5,"select",13)(6,"option",14),l(7),s(),g(8,oo,2,2,"option",15),s()()),t&2){let e=p().$implicit;c(3),N(e.value.label),c(),d("ngIf",e.value.required),c(),d("formControlName",e.key),c(2),x(" Select ",e.value.label," "),c(),d("ngForOf",e.value.options)}}function ao(t,n){t&1&&(a(0,"span",12),l(1,"*"),s())}function lo(t,n){if(t&1&&(a(0,"div",7)(1,"label",8)(2,"span",9),l(3),s(),g(4,ao,2,0,"span",10),s(),S(5,"input",17),s()),t&2){let e=p().$implicit;c(3),N(e.value.label),c(),d("ngIf",e.value.required),c(),d("formControlName",e.key)}}function co(t,n){if(t&1&&(a(0,"div",4)(1,"div",5),g(2,no,6,4,"div",6)(3,so,9,5,"div",6)(4,lo,6,3,"div",6),s()()),t&2){let e=n.$implicit;c(),d("ngSwitch",e.value.type),c(),d("ngSwitchCase","text"),c(),d("ngSwitchCase","select"),c(),d("ngSwitchCase","date")}}var li=(()=>{class t{constructor(e){this.fb=e,this.formFields=xt.required(),this.formSubmit=lt()}ngOnInit(){this.createForm()}createForm(){let e={};e=this.createNestedGroup(this.formFields()),this.dynamicForm=this.fb.group(e),console.log("group",this.dynamicForm)}createNestedGroup(e){let i={};return typeof e!="string"&&Object.keys(e).forEach(r=>{let o=e[r];Array.isArray(o)?o.forEach(m=>{i[r]=this.createNestedGroup(m)}):typeof e[r]=="object"&&(i[r]=[o.value,o.required?w.required:[]])}),i}isArray(e){return Array.isArray(e)}onSubmit(){this.dynamicForm.valid&&this.formSubmit.emit(this.dynamicForm.value)}static{this.\u0275fac=function(i){return new(i||t)(T(ge))}}static{this.\u0275cmp=q({type:t,selectors:[["app-dynamic-form"]],inputs:{formFields:[1,"formFields"]},outputs:{formSubmit:"formSubmit"},standalone:!0,features:[Se],decls:6,vars:4,consts:[[1,"card","bg-amber-100","w-full","max-w-lg","mx-auto","p-6","space-y-2",3,"ngSubmit","formGroup"],["class","form-control",4,"ngFor","ngForOf"],[1,"mt-12"],["type","submit",1,"btn","btn-primary","w-full"],[1,"form-control"],[3,"ngSwitch"],["class","space-y-1",4,"ngSwitchCase"],[1,"space-y-1"],[1,"label","p-0"],[1,"label-text","font-medium"],["class","label-text-alt text-error",4,"ngIf"],["type","text",1,"input","input-bordered","w-full",3,"formControlName","placeholder"],[1,"label-text-alt","text-error"],[1,"select","select-bordered","w-full",3,"formControlName"],["value","","disabled","","selected",""],["class","capitalize",3,"value",4,"ngFor","ngForOf"],[1,"capitalize",3,"value"],["type","date",1,"input","input-bordered","w-full",3,"formControlName"]],template:function(i,r){i&1&&(a(0,"form",0),b("ngSubmit",function(){return r.onSubmit()}),g(1,co,5,4,"div",1),ke(2,"keyvalue"),a(3,"div",2)(4,"button",3),l(5,"Submit"),s()()()),i&2&&(d("formGroup",r.dynamicForm),c(),d("ngForOf",Te(2,2,r.formFields())))},dependencies:[Ee,Pe,re,Mn,An,Rn,Be,ue,Tt,Et,me,kt,de,pe,he,fe]})}}return t})();var Ae=function(t){return t.CONNECTION="connect",t.NEW_MESSAGE="newMessage",t.SUBSCRIBE_TO_CONVERSATION="subscribeToConversation",t.RECEIVE_SUBCRIBE_CONVERSATION="receiveSubscribeConversation",t.RECEIVE_MESSAGE="receiveMessage",t.CONNECT_ROOM="connectRoom",t.JOIN_ROOM="joinRoom",t.CONNECT_ADMIN="connectAdmin",t.SEND_USER_REPLY="sendAdminReply",t.DISCONNECT_ADMIN="disconnectAdmin",t.CREATE_CONVERSATION="createConversation",t.END_CHAT="endChat",t}(Ae||{});var Bi=t=>{let n={};return t.content.type==="text"?n[t.content.type]=t.content.data:n[t.content.type]=JSON.parse(t.content.data),console.log("payload",n),{type:t.content.type,payload:n,isUser:t.sender.type==="user"||t.sender.type==="guest"}};var ci=(()=>{class t{constructor(e){this.http=e,this.apiUrl="https://general-runtime.voiceflow.com/state/user",this.authorization_chat_bot="VF.DM.6768f10323f513b896bec8ed.BRNJsDc8D1YsdpX8"}generateUserID(){let e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);localStorage.setItem("vf_user_id",e)}getUserID(){return localStorage.getItem("vf_user_id")}loadChat(e={tts:!1,stripSSML:!0,stopAll:!1}){return this.generateUserID(),this.http.post(`${this.apiUrl}/${this.getUserID()}/interact?logs=off`,{action:{type:"launch"},config:e},{headers:{"Content-Type":"application/json",Authorization:this.authorization_chat_bot,versionID:"production"}})}interact(e,i={tts:!1,stripSSML:!0,stopAll:!1}){return this.http.post(`${this.apiUrl}/${this.getUserID()}/interact?logs=off`,{action:e,config:{tts:!1,stripSSML:!0,stopAll:!1,excludeTypes:["block","debug","flow"]}},{headers:{"Content-Type":"application/json",Authorization:this.authorization_chat_bot,versionID:"production"}})}deleteState(){return this.http.delete(`${this.apiUrl}/${this.getUserID()}`,{headers:{"Content-Type":"application/json",Authorization:this.authorization_chat_bot,versionID:"production"}}).pipe(J(()=>{localStorage.removeItem("vf_user_id")}))}static{this.\u0275fac=function(i){return new(i||t)(z(Ne))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ue=Object.create(null);Ue.open="0";Ue.close="1";Ue.ping="2";Ue.pong="3";Ue.message="4";Ue.upgrade="5";Ue.noop="6";var Ut=Object.create(null);Object.keys(Ue).forEach(t=>{Ut[Ue[t]]=t});var qt={type:"error",data:"parser error"};var Qn=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Zn=typeof ArrayBuffer=="function",er=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Ht=({type:t,data:n},e,i)=>Qn&&n instanceof Blob?e?i(n):Kn(n,i):Zn&&(n instanceof ArrayBuffer||er(n))?e?i(n):Kn(new Blob([n]),i):i(Ue[t]+(n||"")),Kn=(t,n)=>{let e=new FileReader;return e.onload=function(){let i=e.result.split(",")[1];n("b"+(i||""))},e.readAsDataURL(t)};function Xn(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}var $i;function tr(t,n){if(Qn&&t.data instanceof Blob)return t.data.arrayBuffer().then(Xn).then(n);if(Zn&&(t.data instanceof ArrayBuffer||er(t.data)))return n(Xn(t.data));Ht(t,!1,e=>{$i||($i=new TextEncoder),n($i.encode(e))})}var ir="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<ir.length;t++)Yt[ir.charCodeAt(t)]=t;var nr=t=>{let n=t.length*.75,e=t.length,i,r=0,o,m,u,h;t[t.length-1]==="="&&(n--,t[t.length-2]==="="&&n--);let _=new ArrayBuffer(n),C=new Uint8Array(_);for(i=0;i<e;i+=4)o=Yt[t.charCodeAt(i)],m=Yt[t.charCodeAt(i+1)],u=Yt[t.charCodeAt(i+2)],h=Yt[t.charCodeAt(i+3)],C[r++]=o<<2|m>>4,C[r++]=(m&15)<<4|u>>2,C[r++]=(u&3)<<6|h&63;return _};var po=typeof ArrayBuffer=="function",zt=(t,n)=>{if(typeof t!="string")return{type:"message",data:rr(t,n)};let e=t.charAt(0);return e==="b"?{type:"message",data:uo(t.substring(1),n)}:Ut[e]?t.length>1?{type:Ut[e],data:t.substring(1)}:{type:Ut[e]}:qt},uo=(t,n)=>{if(po){let e=nr(t);return rr(e,n)}else return{base64:!0,data:t}},rr=(t,n)=>{switch(n){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}};var or="",sr=(t,n)=>{let e=t.length,i=new Array(e),r=0;t.forEach((o,m)=>{Ht(o,!1,u=>{i[m]=u,++r===e&&n(i.join(or))})})},ar=(t,n)=>{let e=t.split(or),i=[];for(let r=0;r<e.length;r++){let o=zt(e[r],n);if(i.push(o),o.type==="error")break}return i};function lr(){return new TransformStream({transform(t,n){tr(t,e=>{let i=e.length,r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);let o=new DataView(r.buffer);o.setUint8(0,126),o.setUint16(1,i)}else{r=new Uint8Array(9);let o=new DataView(r.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(i))}t.data&&typeof t.data!="string"&&(r[0]|=128),n.enqueue(r),n.enqueue(e)})}})}var Vi;function mi(t){return t.reduce((n,e)=>n+e.length,0)}function di(t,n){if(t[0].length===n)return t.shift();let e=new Uint8Array(n),i=0;for(let r=0;r<n;r++)e[r]=t[0][i++],i===t[0].length&&(t.shift(),i=0);return t.length&&i<t[0].length&&(t[0]=t[0].slice(i)),e}function cr(t,n){Vi||(Vi=new TextDecoder);let e=[],i=0,r=-1,o=!1;return new TransformStream({transform(m,u){for(e.push(m);;){if(i===0){if(mi(e)<1)break;let h=di(e,1);o=(h[0]&128)===128,r=h[0]&127,r<126?i=3:r===126?i=1:i=2}else if(i===1){if(mi(e)<2)break;let h=di(e,2);r=new DataView(h.buffer,h.byteOffset,h.length).getUint16(0),i=3}else if(i===2){if(mi(e)<8)break;let h=di(e,8),_=new DataView(h.buffer,h.byteOffset,h.length),C=_.getUint32(0);if(C>Math.pow(2,21)-1){u.enqueue(qt);break}r=C*Math.pow(2,32)+_.getUint32(4),i=3}else{if(mi(e)<r)break;let h=di(e,r);u.enqueue(zt(o?h:Vi.decode(h),n)),i=0}if(r===0||r>t){u.enqueue(qt);break}}}})}var Li=4;function W(t){if(t)return ho(t)}function ho(t){for(var n in W.prototype)t[n]=W.prototype[n];return t}W.prototype.on=W.prototype.addEventListener=function(t,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(n),this};W.prototype.once=function(t,n){function e(){this.off(t,e),n.apply(this,arguments)}return e.fn=n,this.on(t,e),this};W.prototype.off=W.prototype.removeListener=W.prototype.removeAllListeners=W.prototype.removeEventListener=function(t,n){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+t];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var i,r=0;r<e.length;r++)if(i=e[r],i===n||i.fn===n){e.splice(r,1);break}return e.length===0&&delete this._callbacks["$"+t],this};W.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var n=new Array(arguments.length-1),e=this._callbacks["$"+t],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(e){e=e.slice(0);for(var i=0,r=e.length;i<r;++i)e[i].apply(this,n)}return this};W.prototype.emitReserved=W.prototype.emit;W.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};W.prototype.hasListeners=function(t){return!!this.listeners(t).length};var it=typeof Promise=="function"&&typeof Promise.resolve=="function"?n=>Promise.resolve().then(n):(n,e)=>e(n,0),ye=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),mr="arraybuffer";function pi(t,...n){return n.reduce((e,i)=>(t.hasOwnProperty(i)&&(e[i]=t[i]),e),{})}var fo=ye.setTimeout,go=ye.clearTimeout;function nt(t,n){n.useNativeTimers?(t.setTimeoutFn=fo.bind(ye),t.clearTimeoutFn=go.bind(ye)):(t.setTimeoutFn=ye.setTimeout.bind(ye),t.clearTimeoutFn=ye.clearTimeout.bind(ye))}var _o=1.33;function dr(t){return typeof t=="string"?vo(t):Math.ceil((t.byteLength||t.size)*_o)}function vo(t){let n=0,e=0;for(let i=0,r=t.length;i<r;i++)n=t.charCodeAt(i),n<128?e+=1:n<2048?e+=2:n<55296||n>=57344?e+=3:(i++,e+=4);return e}function ui(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function pr(t){let n="";for(let e in t)t.hasOwnProperty(e)&&(n.length&&(n+="&"),n+=encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n}function ur(t){let n={},e=t.split("&");for(let i=0,r=e.length;i<r;i++){let o=e[i].split("=");n[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return n}var hi=class extends Error{constructor(n,e,i){super(n),this.description=e,this.context=i,this.type="TransportError"}},rt=class extends W{constructor(n){super(),this.writable=!1,nt(this,n),this.opts=n,this.query=n.query,this.socket=n.socket,this.supportsBinary=!n.forceBase64}onError(n,e,i){return super.emitReserved("error",new hi(n,e,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(n){this.readyState==="open"&&this.write(n)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(n){let e=zt(n,this.socket.binaryType);this.onPacket(e)}onPacket(n){super.emitReserved("packet",n)}onClose(n){this.readyState="closed",super.emitReserved("close",n)}pause(n){}createUri(n,e={}){return n+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){let n=this.opts.hostname;return n.indexOf(":")===-1?n:"["+n+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(n){let e=pr(n);return e.length?"?"+e:""}};var Wt=class extends rt{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(n){this.readyState="pausing";let e=()=>{this.readyState="paused",n()};if(this._polling||!this.writable){let i=0;this._polling&&(i++,this.once("pollComplete",function(){--i||e()})),this.writable||(i++,this.once("drain",function(){--i||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(n){let e=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)};ar(n,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){let n=()=>{this.write([{type:"close"}])};this.readyState==="open"?n():this.once("open",n)}write(n){this.writable=!1,sr(n,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let n=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=ui()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(n,e)}};var hr=!1;try{hr=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var fr=hr;function yo(){}var ji=class extends Wt{constructor(n){if(super(n),typeof location<"u"){let e=location.protocol==="https:",i=location.port;i||(i=e?"443":"80"),this.xd=typeof location<"u"&&n.hostname!==location.hostname||i!==n.port}}doWrite(n,e){let i=this.request({method:"POST",data:n});i.on("success",e),i.on("error",(r,o)=>{this.onError("xhr post error",r,o)})}doPoll(){let n=this.request();n.on("data",this.onData.bind(this)),n.on("error",(e,i)=>{this.onError("xhr poll error",e,i)}),this.pollXhr=n}},fi=(()=>{class t extends W{constructor(e,i,r){super(),this.createRequest=e,nt(this,r),this._opts=r,this._method=r.method||"GET",this._uri=i,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;let i=pi(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");i.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(i);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&r.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var o;r.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=t.requestsCount++,t.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=yo,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete t.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}return t.requestsCount=0,t.requests={},t})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",gr);else if(typeof addEventListener=="function"){let t="onpagehide"in ye?"pagehide":"unload";addEventListener(t,gr,!1)}}function gr(){for(let t in fi.requests)fi.requests.hasOwnProperty(t)&&fi.requests[t].abort()}var xo=function(){let t=_r({xdomain:!1});return t&&t.responseType!==null}(),ut=class extends ji{constructor(n){super(n);let e=n&&n.forceBase64;this.supportsBinary=xo&&!e}request(n={}){return Object.assign(n,{xd:this.xd},this.opts),new fi(_r,this.uri(),n)}};function _r(t){let n=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!n||fr))return new XMLHttpRequest}catch{}if(!n)try{return new ye[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}var vr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",qi=class extends rt{get name(){return"websocket"}doOpen(){let n=this.uri(),e=this.opts.protocols,i=vr?{}:pi(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(n,e,i)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=n=>this.onClose({description:"websocket connection closed",context:n}),this.ws.onmessage=n=>this.onData(n.data),this.ws.onerror=n=>this.onError("websocket error",n)}write(n){this.writable=!1;for(let e=0;e<n.length;e++){let i=n[e],r=e===n.length-1;Ht(i,this.supportsBinary,o=>{try{this.doWrite(i,o)}catch{}r&&it(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let n=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=ui()),this.supportsBinary||(e.b64=1),this.createUri(n,e)}},Ui=ye.WebSocket||ye.MozWebSocket,ht=class extends qi{createSocket(n,e,i){return vr?new Ui(n,e,i):e?new Ui(n,e):new Ui(n)}doWrite(n,e){this.ws.send(e)}};var Ft=class extends rt{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(n){return this.emitReserved("error",n)}this._transport.closed.then(()=>{this.onClose()}).catch(n=>{this.onError("webtransport error",n)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(n=>{let e=cr(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=n.readable.pipeThrough(e).getReader(),r=lr();r.readable.pipeTo(n.writable),this._writer=r.writable.getWriter();let o=()=>{i.read().then(({done:u,value:h})=>{u||(this.onPacket(h),o())}).catch(u=>{})};o();let m={type:"open"};this.query.sid&&(m.data=`{"sid":"${this.query.sid}"}`),this._writer.write(m).then(()=>this.onOpen())})})}write(n){this.writable=!1;for(let e=0;e<n.length;e++){let i=n[e],r=e===n.length-1;this._writer.write(i).then(()=>{r&&it(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var n;(n=this._transport)===null||n===void 0||n.close()}};var Hi={websocket:ht,webtransport:Ft,polling:ut};var bo=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Co=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Dt(t){if(t.length>8e3)throw"URI too long";let n=t,e=t.indexOf("["),i=t.indexOf("]");e!=-1&&i!=-1&&(t=t.substring(0,e)+t.substring(e,i).replace(/:/g,";")+t.substring(i,t.length));let r=bo.exec(t||""),o={},m=14;for(;m--;)o[Co[m]]=r[m]||"";return e!=-1&&i!=-1&&(o.source=n,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=wo(o,o.path),o.queryKey=So(o,o.query),o}function wo(t,n){let e=/\/{2,9}/g,i=n.replace(e,"/").split("/");return(n.slice(0,1)=="/"||n.length===0)&&i.splice(0,1),n.slice(-1)=="/"&&i.splice(i.length-1,1),i}function So(t,n){let e={};return n.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,r,o){r&&(e[r]=o)}),e}var Yi=typeof addEventListener=="function"&&typeof removeEventListener=="function",gi=[];Yi&&addEventListener("offline",()=>{gi.forEach(t=>t())},!1);var _i=(()=>{class t extends W{constructor(e,i){if(super(),this.binaryType=mr,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(i=e,e=null),e){let r=Dt(e);i.hostname=r.host,i.secure=r.protocol==="https"||r.protocol==="wss",i.port=r.port,r.query&&(i.query=r.query)}else i.host&&(i.hostname=Dt(i.host).host);nt(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},i.transports.forEach(r=>{let o=r.prototype.name;this.transports.push(o),this._transportsByName[o]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ur(this.opts.query)),Yi&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},gi.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){let i=Object.assign({},this.opts.query);i.EIO=Li,i.transport=e,this.id&&(i.sid=this.id);let r=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&t.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let i=this.createTransport(e);i.open(),this.setTransport(i)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",i=>this._onClose("transport close",i))}onOpen(){this.readyState="open",t.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let i=new Error("server error");i.code=e.data,this._onError(i);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let r=0;r<this.writeBuffer.length;r++){let o=this.writeBuffer[r].data;if(o&&(i+=dr(o)),r>0&&i>this._maxPayload)return this.writeBuffer.slice(0,r);i+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,it(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,i,r){return this._sendPacket("message",e,i,r),this}send(e,i,r){return this._sendPacket("message",e,i,r),this}_sendPacket(e,i,r,o){if(typeof i=="function"&&(o=i,i=void 0),typeof r=="function"&&(o=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let m={type:e,data:i,options:r};this.emitReserved("packetCreate",m),this.writeBuffer.push(m),o&&this.once("flush",o),this.flush()}close(){let e=()=>{this._onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),e()},r=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(t.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,i){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Yi&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let r=gi.indexOf(this._offlineEventListener);r!==-1&&gi.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,i),this.writeBuffer=[],this._prevBufferLen=0}}}return t.protocol=Li,t})(),vi=class extends _i{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let n=0;n<this._upgrades.length;n++)this._probe(this._upgrades[n])}_probe(n){let e=this.createTransport(n),i=!1;_i.priorWebsocketSuccess=!1;let r=()=>{i||(e.send([{type:"ping",data:"probe"}]),e.once("packet",L=>{if(!i)if(L.type==="pong"&&L.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;_i.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{i||this.readyState!=="closed"&&(C(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{let ee=new Error("probe error");ee.transport=e.name,this.emitReserved("upgradeError",ee)}}))};function o(){i||(i=!0,C(),e.close(),e=null)}let m=L=>{let ee=new Error("probe error: "+L);ee.transport=e.name,o(),this.emitReserved("upgradeError",ee)};function u(){m("transport closed")}function h(){m("socket closed")}function _(L){e&&L.name!==e.name&&o()}let C=()=>{e.removeListener("open",r),e.removeListener("error",m),e.removeListener("close",u),this.off("close",h),this.off("upgrading",_)};e.once("open",r),e.once("error",m),e.once("close",u),this.once("close",h),this.once("upgrading",_),this._upgrades.indexOf("webtransport")!==-1&&n!=="webtransport"?this.setTimeoutFn(()=>{i||e.open()},200):e.open()}onHandshake(n){this._upgrades=this._filterUpgrades(n.upgrades),super.onHandshake(n)}_filterUpgrades(n){let e=[];for(let i=0;i<n.length;i++)~this.transports.indexOf(n[i])&&e.push(n[i]);return e}},Mt=class extends vi{constructor(n,e={}){let i=typeof n=="object"?n:e;(!i.transports||i.transports&&typeof i.transports[0]=="string")&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(r=>Hi[r]).filter(r=>!!r)),super(n,i)}};var ac=Mt.protocol;function yr(t,n="",e){let i=t;e=e||typeof location<"u"&&location,t==null&&(t=e.protocol+"//"+e.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=e.protocol+t:t=e.host+t),/^(https?|wss?):\/\//.test(t)||(typeof e<"u"?t=e.protocol+"//"+t:t="https://"+t),i=Dt(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let o=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+n,i.href=i.protocol+"://"+o+(e&&e.port===i.port?"":":"+i.port),i}var Xi={};to(Xi,{Decoder:()=>Ji,Encoder:()=>Gi,PacketType:()=>P,protocol:()=>Sr});var To=typeof ArrayBuffer=="function",Eo=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,xr=Object.prototype.toString,Io=typeof Blob=="function"||typeof Blob<"u"&&xr.call(Blob)==="[object BlobConstructor]",Fo=typeof File=="function"||typeof File<"u"&&xr.call(File)==="[object FileConstructor]";function Jt(t){return To&&(t instanceof ArrayBuffer||Eo(t))||Io&&t instanceof Blob||Fo&&t instanceof File}function Gt(t,n){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let e=0,i=t.length;e<i;e++)if(Gt(t[e]))return!0;return!1}if(Jt(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Gt(t.toJSON(),!0);for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&Gt(t[e]))return!0;return!1}function br(t){let n=[],e=t.data,i=t;return i.data=zi(e,n),i.attachments=n.length,{packet:i,buffers:n}}function zi(t,n){if(!t)return t;if(Jt(t)){let e={_placeholder:!0,num:n.length};return n.push(t),e}else if(Array.isArray(t)){let e=new Array(t.length);for(let i=0;i<t.length;i++)e[i]=zi(t[i],n);return e}else if(typeof t=="object"&&!(t instanceof Date)){let e={};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=zi(t[i],n));return e}return t}function Cr(t,n){return t.data=Wi(t.data,n),delete t.attachments,t}function Wi(t,n){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<n.length)return n[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let e=0;e<t.length;e++)t[e]=Wi(t[e],n);else if(typeof t=="object")for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&(t[e]=Wi(t[e],n));return t}var Do=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Sr=5,P=function(t){return t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK",t}(P||{}),Gi=class{constructor(n){this.replacer=n}encode(n){return(n.type===P.EVENT||n.type===P.ACK)&&Gt(n)?this.encodeAsBinary({type:n.type===P.EVENT?P.BINARY_EVENT:P.BINARY_ACK,nsp:n.nsp,data:n.data,id:n.id}):[this.encodeAsString(n)]}encodeAsString(n){let e=""+n.type;return(n.type===P.BINARY_EVENT||n.type===P.BINARY_ACK)&&(e+=n.attachments+"-"),n.nsp&&n.nsp!=="/"&&(e+=n.nsp+","),n.id!=null&&(e+=n.id),n.data!=null&&(e+=JSON.stringify(n.data,this.replacer)),e}encodeAsBinary(n){let e=br(n),i=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(i),r}};function wr(t){return Object.prototype.toString.call(t)==="[object Object]"}var Ji=class t extends W{constructor(n){super(),this.reviver=n}add(n){let e;if(typeof n=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(n);let i=e.type===P.BINARY_EVENT;i||e.type===P.BINARY_ACK?(e.type=i?P.EVENT:P.ACK,this.reconstructor=new Ki(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Jt(n)||n.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(n),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+n)}decodeString(n){let e=0,i={type:Number(n.charAt(0))};if(P[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===P.BINARY_EVENT||i.type===P.BINARY_ACK){let o=e+1;for(;n.charAt(++e)!=="-"&&e!=n.length;);let m=n.substring(o,e);if(m!=Number(m)||n.charAt(e)!=="-")throw new Error("Illegal attachments");i.attachments=Number(m)}if(n.charAt(e+1)==="/"){let o=e+1;for(;++e&&!(n.charAt(e)===","||e===n.length););i.nsp=n.substring(o,e)}else i.nsp="/";let r=n.charAt(e+1);if(r!==""&&Number(r)==r){let o=e+1;for(;++e;){let m=n.charAt(e);if(m==null||Number(m)!=m){--e;break}if(e===n.length)break}i.id=Number(n.substring(o,e+1))}if(n.charAt(++e)){let o=this.tryParse(n.substr(e));if(t.isPayloadValid(i.type,o))i.data=o;else throw new Error("invalid payload")}return i}tryParse(n){try{return JSON.parse(n,this.reviver)}catch{return!1}}static isPayloadValid(n,e){switch(n){case P.CONNECT:return wr(e);case P.DISCONNECT:return e===void 0;case P.CONNECT_ERROR:return typeof e=="string"||wr(e);case P.EVENT:case P.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&Do.indexOf(e[0])===-1);case P.ACK:case P.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},Ki=class{constructor(n){this.packet=n,this.buffers=[],this.reconPack=n}takeBinaryData(n){if(this.buffers.push(n),this.buffers.length===this.reconPack.attachments){let e=Cr(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Re(t,n,e){return t.on(n,e),function(){t.off(n,e)}}var Mo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),At=class extends W{constructor(n,e,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=n,this.nsp=e,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let n=this.io;this.subs=[Re(n,"open",this.onopen.bind(this)),Re(n,"packet",this.onpacket.bind(this)),Re(n,"error",this.onerror.bind(this)),Re(n,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...n){return n.unshift("message"),this.emit.apply(this,n),this}emit(n,...e){var i,r,o;if(Mo.hasOwnProperty(n))throw new Error('"'+n.toString()+'" is a reserved event name');if(e.unshift(n),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;let m={type:P.EVENT,data:e};if(m.options={},m.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){let C=this.ids++,L=e.pop();this._registerAckCallback(C,L),m.id=C}let u=(r=(i=this.io.engine)===null||i===void 0?void 0:i.transport)===null||r===void 0?void 0:r.writable,h=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!u||(h?(this.notifyOutgoingListeners(m),this.packet(m)):this.sendBuffer.push(m)),this.flags={},this}_registerAckCallback(n,e){var i;let r=(i=this.flags.timeout)!==null&&i!==void 0?i:this._opts.ackTimeout;if(r===void 0){this.acks[n]=e;return}let o=this.io.setTimeoutFn(()=>{delete this.acks[n];for(let u=0;u<this.sendBuffer.length;u++)this.sendBuffer[u].id===n&&this.sendBuffer.splice(u,1);e.call(this,new Error("operation has timed out"))},r),m=(...u)=>{this.io.clearTimeoutFn(o),e.apply(this,u)};m.withError=!0,this.acks[n]=m}emitWithAck(n,...e){return new Promise((i,r)=>{let o=(m,u)=>m?r(m):i(u);o.withError=!0,e.push(o),this.emit(n,...e)})}_addToQueue(n){let e;typeof n[n.length-1]=="function"&&(e=n.pop());let i={id:this._queueSeq++,tryCount:0,pending:!1,args:n,flags:Object.assign({fromQueue:!0},this.flags)};n.push((r,...o)=>i!==this._queue[0]?void 0:(r!==null?i.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(r)):(this._queue.shift(),e&&e(null,...o)),i.pending=!1,this._drainQueue())),this._queue.push(i),this._drainQueue()}_drainQueue(n=!1){if(!this.connected||this._queue.length===0)return;let e=this._queue[0];e.pending&&!n||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(n){n.nsp=this.nsp,this.io._packet(n)}onopen(){typeof this.auth=="function"?this.auth(n=>{this._sendConnectPacket(n)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(n){this.packet({type:P.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},n):n})}onerror(n){this.connected||this.emitReserved("connect_error",n)}onclose(n,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",n,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(n=>{if(!this.sendBuffer.some(i=>String(i.id)===n)){let i=this.acks[n];delete this.acks[n],i.withError&&i.call(this,new Error("socket has been disconnected"))}})}onpacket(n){if(n.nsp===this.nsp)switch(n.type){case P.CONNECT:n.data&&n.data.sid?this.onconnect(n.data.sid,n.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case P.EVENT:case P.BINARY_EVENT:this.onevent(n);break;case P.ACK:case P.BINARY_ACK:this.onack(n);break;case P.DISCONNECT:this.ondisconnect();break;case P.CONNECT_ERROR:this.destroy();let i=new Error(n.data.message);i.data=n.data.data,this.emitReserved("connect_error",i);break}}onevent(n){let e=n.data||[];n.id!=null&&e.push(this.ack(n.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(n){if(this._anyListeners&&this._anyListeners.length){let e=this._anyListeners.slice();for(let i of e)i.apply(this,n)}super.emit.apply(this,n),this._pid&&n.length&&typeof n[n.length-1]=="string"&&(this._lastOffset=n[n.length-1])}ack(n){let e=this,i=!1;return function(...r){i||(i=!0,e.packet({type:P.ACK,id:n,data:r}))}}onack(n){let e=this.acks[n.id];typeof e=="function"&&(delete this.acks[n.id],e.withError&&n.data.unshift(null),e.apply(this,n.data))}onconnect(n,e){this.id=n,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(n=>this.emitEvent(n)),this.receiveBuffer=[],this.sendBuffer.forEach(n=>{this.notifyOutgoingListeners(n),this.packet(n)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(n=>n()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:P.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(n){return this.flags.compress=n,this}get volatile(){return this.flags.volatile=!0,this}timeout(n){return this.flags.timeout=n,this}onAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(n),this}prependAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(n),this}offAny(n){if(!this._anyListeners)return this;if(n){let e=this._anyListeners;for(let i=0;i<e.length;i++)if(n===e[i])return e.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(n),this}prependAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(n),this}offAnyOutgoing(n){if(!this._anyOutgoingListeners)return this;if(n){let e=this._anyOutgoingListeners;for(let i=0;i<e.length;i++)if(n===e[i])return e.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(n){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let e=this._anyOutgoingListeners.slice();for(let i of e)i.apply(this,n.data)}}};function vt(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}vt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),e=Math.floor(n*this.jitter*t);t=Math.floor(n*10)&1?t+e:t-e}return Math.min(t,this.max)|0};vt.prototype.reset=function(){this.attempts=0};vt.prototype.setMin=function(t){this.ms=t};vt.prototype.setMax=function(t){this.max=t};vt.prototype.setJitter=function(t){this.jitter=t};var Rt=class extends W{constructor(n,e){var i;super(),this.nsps={},this.subs=[],n&&typeof n=="object"&&(e=n,n=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,nt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((i=e.randomizationFactor)!==null&&i!==void 0?i:.5),this.backoff=new vt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=n;let r=e.parser||Xi;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(n){return arguments.length?(this._reconnection=!!n,n||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(n){return n===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=n,this)}reconnectionDelay(n){var e;return n===void 0?this._reconnectionDelay:(this._reconnectionDelay=n,(e=this.backoff)===null||e===void 0||e.setMin(n),this)}randomizationFactor(n){var e;return n===void 0?this._randomizationFactor:(this._randomizationFactor=n,(e=this.backoff)===null||e===void 0||e.setJitter(n),this)}reconnectionDelayMax(n){var e;return n===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=n,(e=this.backoff)===null||e===void 0||e.setMax(n),this)}timeout(n){return arguments.length?(this._timeout=n,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(n){if(~this._readyState.indexOf("open"))return this;this.engine=new Mt(this.uri,this.opts);let e=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let r=Re(e,"open",function(){i.onopen(),n&&n()}),o=u=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",u),n?n(u):this.maybeReconnectOnOpen()},m=Re(e,"error",o);if(this._timeout!==!1){let u=this._timeout,h=this.setTimeoutFn(()=>{r(),o(new Error("timeout")),e.close()},u);this.opts.autoUnref&&h.unref(),this.subs.push(()=>{this.clearTimeoutFn(h)})}return this.subs.push(r),this.subs.push(m),this}connect(n){return this.open(n)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let n=this.engine;this.subs.push(Re(n,"ping",this.onping.bind(this)),Re(n,"data",this.ondata.bind(this)),Re(n,"error",this.onerror.bind(this)),Re(n,"close",this.onclose.bind(this)),Re(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(n){try{this.decoder.add(n)}catch(e){this.onclose("parse error",e)}}ondecoded(n){it(()=>{this.emitReserved("packet",n)},this.setTimeoutFn)}onerror(n){this.emitReserved("error",n)}socket(n,e){let i=this.nsps[n];return i?this._autoConnect&&!i.active&&i.connect():(i=new At(this,n,e),this.nsps[n]=i),i}_destroy(n){let e=Object.keys(this.nsps);for(let i of e)if(this.nsps[i].active)return;this._close()}_packet(n){let e=this.encoder.encode(n);for(let i=0;i<e.length;i++)this.engine.write(e[i],n.options)}cleanup(){this.subs.forEach(n=>n()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(n,e){var i;this.cleanup(),(i=this.engine)===null||i===void 0||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",n,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let n=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let e=this.backoff.duration();this._reconnecting=!0;let i=this.setTimeoutFn(()=>{n.skipReconnect||(this.emitReserved("reconnect_attempt",n.backoff.attempts),!n.skipReconnect&&n.open(r=>{r?(n._reconnecting=!1,n.reconnect(),this.emitReserved("reconnect_error",r)):n.onreconnect()}))},e);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){let n=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",n)}};var Kt={};function Xt(t,n){typeof t=="object"&&(n=t,t=void 0),n=n||{};let e=yr(t,n.path||"/socket.io"),i=e.source,r=e.id,o=e.path,m=Kt[r]&&o in Kt[r].nsps,u=n.forceNew||n["force new connection"]||n.multiplex===!1||m,h;return u?h=new Rt(i,n):(Kt[r]||(Kt[r]=new Rt(i,n)),h=Kt[r]),e.query&&!n.query&&(n.query=e.queryKey),h.socket(e.path,n)}Object.assign(Xt,{Manager:Rt,Socket:At,io:Xt,connect:Xt});var Ao="http://3.27.183.125",yi=(()=>{class t{constructor(e){this.tokenService=e,this.socketID="",this.clientSocket=this.connectSocket(),this.clientSocket.on("connect",()=>{console.log("Socket connected:",this.clientSocket.id),console.log("socket",this.clientSocket)}),this.clientSocket.on("connect_error",i=>{console.error("Socket connection error:",i)})}connectSocket(){return Xt(Ao,{auth:{token:this.tokenService.getAccessToken()},transports:["websocket"]})}getSocket(){return this.clientSocket}generateHashID(){let e="0123456789abcdef",i="";for(let r=0;r<24;r++)i+=e[Math.floor(Math.random()*e.length)];return i}listenToServer(e){return new mn(i=>{this.clientSocket.on(e,r=>{i.next(r)})})}emitToServer(e,i){this.clientSocket.emit(e,i)}static{this.\u0275fac=function(i){return new(i||t)(z($e))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var kr=(()=>{class t{constructor(e){this.http=e}getRoomByID(e){return this.http.get(`${se}/mongo/room/${e}`)}createRoom(e){return this.http.post(`${se}/mongo/room/create`,e)}static{this.\u0275fac=function(i){return new(i||t)(z(Ne))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Tr=(()=>{class t{constructor(e){this.http=e}getUserByField(e){let i=Object.entries(e).map(([r,o])=>`${r}=${o}`).join("&");return this.http.get(`${se}/mongo/user/search?${i}`)}getUserByID(e){return this.http.get(`${se}/mongo/user/${e}`)}createUser(e){return this.http.post(`${se}/mongo/user/create`,e)}static{this.\u0275fac=function(i){return new(i||t)(z(Ne))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Er=(()=>{class t{constructor(e){this.http=e}getMessagesByRoomID(e){return this.http.get(`${se}/mongo/message/room/${e}`)}static{this.\u0275fac=function(i){return new(i||t)(z(Ne))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Bo=["chatContainer"],$o=["scrollContainer"],Vo=t=>({"flex flex-col":!0,"items-end":t}),Lo=(t,n)=>({"max-w-[80%] rounded-lg p-3 mb-2":!0,"bg-blue-500 text-white":t,"bg-gray-100 text-black":n}),Ir=(t,n)=>({"badge-neutral":t,"badge-success text-white":n}),jo=()=>({}),Uo=(t,n)=>({"translate-y-0 opacity-100":t,"translate-y-full opacity-0":n});function qo(t,n){if(t&1){let e=V();a(0,"button",4),b("click",function(){F(e);let r=p();return D(r.toggleMinimize())}),a(1,"span",5),l(2,"chat"),s()()}}function Ho(t,n){if(t&1&&(a(0,"div",19),l(1),s()),t&2){let e=p().$implicit;d("ngClass",Vt(2,Lo,e.isUser,!e.isUser)),c(),x(" ",e.payload==null?null:e.payload.text," ")}}function Yo(t,n){if(t&1){let e=V();a(0,"button",24),b("click",function(){let r=F(e).$implicit,o=p(4);return D(o.handleChoiceSelection(r))}),l(1),s()}if(t&2){let e=n.$implicit;c(),x(" ",e.request.payload.label," ")}}function zo(t,n){if(t&1&&(a(0,"div",20),g(1,Yo,2,1,"button",23),s()),t&2){let e=p().$implicit;c(),d("ngForOf",e.payload==null?null:e.payload.choice)}}function Wo(t,n){if(t&1&&(a(0,"span",31),l(1),s()),t&2){let e=p().$implicit;d("ngClass",Vt(2,Ir,e.variables.tags.includes("cheapest"),e.variables.tags.includes("shortest"))),c(),x(" ",e.variables.tags," ")}}function Go(t,n){if(t&1){let e=V();a(0,"button",36),b("click",function(){let r=F(e).$implicit,o=p(5);return D(o.handleSelectionCarousel(r))}),l(1),s()}if(t&2){let e=n.$implicit;c(),x(" ",e.request.payload.label," ")}}function Jo(t,n){if(t&1&&(a(0,"div",26)(1,"div",27)(2,"figure"),S(3,"img",28),s(),a(4,"div",29)(5,"div")(6,"h2",30),l(7),s(),g(8,Wo,2,5,"span",31),s(),a(9,"div",32),S(10,"div",33),s(),a(11,"div",34),le(12,Go,2,1,"button",35,je),s()()()()),t&2){let e=n.$implicit,i=n.index,r=p(4);Tn("id","slide",i,""),c(3),d("src",e.imageUrl,Ze)("alt",e.title),c(4),N(e.title),c(),Q(e.variables&&e.variables.tags?8:-1),c(2),d("innerHTML",r.renderStyledText(e.description.slate[0].children),Di),c(2),ce(e.buttons)}}function Ko(t,n){if(t&1&&(a(0,"div",21),g(1,Jo,14,7,"div",25),s()),t&2){let e=p().$implicit;c(),d("ngForOf",e.payload==null?null:e.payload.carousel)}}function Xo(t,n){if(t&1&&(a(0,"span",31),l(1),s()),t&2){let e=p(2).$implicit;d("ngClass",Vt(2,Ir,e.payload==null?null:e.payload.cardV2[0].variables.tags.includes("cheapest"),e.payload==null?null:e.payload.cardV2[0].variables.tags.includes("shortest"))),c(),x(" ",e.payload==null?null:e.payload.cardV2[0].variables.tags," ")}}function Qo(t,n){if(t&1){let e=V();a(0,"button",46),b("click",function(){let r=F(e).$implicit,o=p(4);return D(o.handleSelectionCarousel(r))}),l(1),s()}if(t&2){let e=n.$implicit;c(),x(" ",e.request.payload.label," ")}}function Zo(t,n){if(t&1&&(a(0,"div",22)(1,"figure",37),S(2,"img",38),s(),a(3,"div",39)(4,"div",40)(5,"h2",41),l(6),s(),g(7,Xo,2,5,"span",31),s(),a(8,"div",42),S(9,"div",43),s(),a(10,"div",44),le(11,Qo,2,1,"button",45,je),s()()()),t&2){let e=p().$implicit,i=p(2);c(2),d("src",e.payload==null?null:e.payload.cardV2[0].imageUrl,Ze)("alt",e.payload==null?null:e.payload.cardV2[0].title),c(4),x(" ",e.payload==null?null:e.payload.cardV2[0].title," "),c(),Q(e.payload!=null&&e.payload.cardV2[0].variables&&(e.payload!=null&&e.payload.cardV2[0].variables.tags)?7:-1),c(2),d("innerHTML",i.renderStyledText(e.payload==null?null:e.payload.cardV2[0].description.slate[0].children),Di),c(2),ce(e.payload==null?null:e.payload.cardV2[0].buttons)}}function es(t,n){if(t&1){let e=V();a(0,"app-dynamic-form",48),b("formSubmit",function(r){F(e);let o=p(4);return D(o.onFormSubmit(r))}),s()}if(t&2){let e=p(2).$implicit;d("formFields",(e.payload==null?null:e.payload.formField)||Ct(1,jo))}}function ts(t,n){if(t&1&&g(0,es,1,2,"app-dynamic-form",47),t&2){let e=p().$implicit;Q(e.payload!=null&&e.payload.formField?0:-1)}}function is(t,n){if(t&1&&(a(0,"div",19),g(1,Ho,2,5,"div",19)(2,zo,2,1,"div",20)(3,Ko,2,1,"div",21)(4,Zo,13,5,"div",22)(5,ts,1,1),s()),t&2){let e=n.$implicit;d("ngClass",tt(2,Vo,e.isUser)),c(),Q(e.type=="text"?1:e.type==="choice"?2:e.type==="carousel"?3:e.type==="cardV2"?4:e.type==="custom_form"?5:-1)}}function ns(t,n){t&1&&(a(0,"div",49),S(1,"div",50)(2,"div",51)(3,"div",52),s())}function rs(t,n){if(t&1){let e=V();a(0,"div",53),b("click",function(){F(e);let r=p(2);return D(r.showEndChat=!1)}),s()}}function os(t,n){if(t&1){let e=V();a(0,"div",54)(1,"div",55)(2,"p",56),l(3," Are you sure you want to end this chat? "),s(),a(4,"div",57)(5,"button",58),b("click",function(){F(e);let r=p(2);return D(r.endChat())}),l(6," End Chat "),s(),a(7,"button",59),b("click",function(){F(e);let r=p(2);return D(r.showEndChat=!1)}),l(8," Cancel "),s()()()()}if(t&2){let e=p(2);d("ngClass",Vt(1,Uo,e.showEndChat,!e.showEndChat))}}function ss(t,n){if(t&1){let e=V();a(0,"div",6)(1,"div",7)(2,"h3"),l(3,"Chat Assistant"),s(),a(4,"div",8)(5,"button",9),b("click",function(){F(e);let r=p();return D(r.toggleMinimize())}),a(6,"span",5),l(7),s()(),a(8,"label",10),b("click",function(){F(e);let r=p();return D(r.showEndChatPopup())}),a(9,"span",5),l(10,"close"),s()()()(),a(11,"div",11,0),g(13,is,6,4,"div",12)(14,ns,4,0,"div",13),s(),a(15,"form",14),b("ngSubmit",function(){F(e);let r=p();return D(r.sendMessage())}),a(16,"div",8),S(17,"input",15),a(18,"button",16)(19,"span",5),l(20," send "),s()()()(),g(21,rs,1,0,"div",17)(22,os,9,4,"div",18),s()}if(t&2){let e=p();c(7),N(e.isMinimized?"expand_more":"remove"),c(6),d("ngForOf",e.messages),c(),d("ngIf",e.isTyping),c(),d("formGroup",e.chatForm),c(3),d("disabled",!e.chatForm.valid),c(3),d("ngIf",e.showEndChat),c(),d("ngIf",e.showEndChat)}}var xi=(()=>{class t{constructor(e,i,r,o,m,u,h){this._fb=e,this.chatBotService=i,this.router=r,this.socketService=o,this.roomService=m,this.userService=u,this.messageService=h,this.chatContainer=Mi("chatContainer"),this.scrollContainer=Mi("scrollContainer"),this.messages=[],this.isTyping=!1,this.isMinimized=!1,this.showEndChat=!1,this.desCarousel="",this.formFields=ae({}),this.assistantID="6780f3bf9a9aeafb2ad5c778",this.room_id="",this.socket_room_name="",this.user_id="",this.userType="guest",this.renderStyledText=_=>_.map(C=>{let L="";return C.fontWeight==="700"&&(L+="font-bold "),C.color&&(L+=`color: rgb(${C.color.r},${C.color.g},${C.color.b}) `),C.underline&&(L+="text-decoration-line: underline "),`<span class="${L.trim()}">${C.text}</span>`}).join(""),this.initForm(),this.socketService.listenToServer(Ae.SUBSCRIBE_TO_CONVERSATION).subscribe(_=>{}),this.socketService.listenToServer(Ae.NEW_MESSAGE).subscribe(_=>{console.log("NEW_MESSAGE",_)}),this.socketService.listenToServer(Ae.RECEIVE_SUBCRIBE_CONVERSATION).subscribe(_=>{console.log("RECEIVE_SUBCRIBE_CONVERSATION",_);let C=[{type:"text",payload:{message:"Assign to admin successfully"}}];this.pushMessage(C,"assistant")}),this.socketService.listenToServer(Ae.DISCONNECT_ADMIN).subscribe(()=>{this.setIsTalkingWithAD(!1),console.log("Admin disconnected");let _=[{type:"text",payload:{message:"You are now chatting with our AI assistant. How can I help you?"}}];this.pushMessage(_,"assistant")}),this.socketService.listenToServer(Ae.RECEIVE_MESSAGE).subscribe(_=>{console.log("RECEIVE_MESSAGE",_),this.messages.push(Bi(_))})}ngOnInit(){this.socketService.getSocket().on("connect",()=>{this.initRoom()})}initRoom(){let e=localStorage.getItem("userEmail"),i=localStorage.getItem("roomID"),r=localStorage.getItem("socket_room_name");if(console.log("roomID",i),i&&r)this.socketService.emitToServer(Ae.CONNECT_ROOM,{socket_room_name:r}),this.messages=[],this.roomService.getRoomByID(i).subscribe(o=>{console.log("data",o),o.rooms.participants.forEach(m=>{m.user_id!==this.assistantID&&this.setUserID(m.user_id)}),this.setRoomID(o.rooms._id)}),this.messageService.getMessagesByRoomID(i).subscribe(o=>{console.log("new message when roomID exist",o),this.messages=o.messages.map(m=>(console.log("message",m),Bi(m)))});else{if(console.log("email",e),e)this.userService.getUserByField({email:e}).subscribe(o=>{o.user.length?(this.setUserType("user"),this.setUserID(o.user[0].user_id),console.log("user",this.getUserID()),this.createChatRoom(e)):console.log("This User doesn't exist! ")});else{this.setUserID(this.socketService.generateHashID());let o={user_id:this.getUserID(),type:"guest",is_temporary:!0};this.userService.createUser(o).subscribe(m=>{console.log("guest created",m),this.setUserType("guest"),this.createChatRoom(e)})}setTimeout(()=>this.scrollToBottom(),100)}}createChatRoom(e){console.log("function createChatRoom",(e?"User:":"Guest:")+(e||this.getUserID())),this.setSocketRoomName((e?"User:":"Guest:")+(e||this.getUserID())),this.roomService.createRoom({status:"talk_with_bot",name:this.getSocketRoomName(),participants:[{user_id:this.assistantID}],socket:{socket_room_name:this.socket_room_name}}).subscribe(i=>{this.setRoomID(i.room._id),console.log("room",i.room._id),localStorage.setItem("roomID",this.getRoomID()),this.initChat(),console.log("room_id",this.getRoomID()),console.log("user_id",this.getUserID()),console.log("socket_room_name",this.getSocketRoomName()),this.socketService.emitToServer(Ae.JOIN_ROOM,{socket_room_name:this.getSocketRoomName(),room_id:this.getRoomID(),email:e}),localStorage.setItem("socket_room_name",this.getSocketRoomName())})}setUserID(e){this.user_id=e}getUserID(){return this.user_id}setRoomID(e){this.room_id=e}getRoomID(){return this.room_id}setIsTalkingWithAD(e){localStorage.setItem("IsTalkingWithAD",e.toString())}getIsTalkingWithAD(){return localStorage.getItem("IsTalkingWithAD")==="true"}setSocketRoomName(e){this.socket_room_name=e}getSocketRoomName(){return this.socket_room_name}setUserType(e){this.userType=e}getUserType(){return this.userType}onChange(e){console.log("change",e)}initForm(){this.chatForm=this._fb.group({message:["",w.required]})}initChat(){this.chatBotService.loadChat().subscribe(e=>{console.log("load chat ",e),this.isTyping=!0,this.pushMessage(e,"assistant")})}isJSON(e){try{return JSON.parse(e),!0}catch{return!1}}toggleMinimize(){this.isMinimized=!this.isMinimized,this.chatBotService.getUserID()===""&&this.initRoom()}showEndChatPopup(){this.showEndChat=!0}scrollToBottom(){try{this.scrollContainer().nativeElement.scrollTop=this.scrollContainer().nativeElement.scrollHeight}catch{}}sendMessage(){if(this.chatForm.valid){let e=[{type:"text",payload:{message:this.chatForm.value.message}}];this.pushMessage(e,this.getUserType()),setTimeout(()=>this.scrollToBottom(),100),this.chatForm.reset(),console.log("isTalkWithAD",this.getIsTalkingWithAD()),this.getIsTalkingWithAD()?this.socketService.emitToServer(Ae.NEW_MESSAGE,{chat_type:"text",message:this.messages.slice(-1)[0].payload[this.messages.slice(-1)[0].type],room_id:this.getRoomID(),user_id:this.getUserID(),user_type:this.getUserType(),is_read:!1,read_by:[{user_id:this.getUserID()}]}):this.chatBotService.interact({type:"text",payload:e[0].payload.message}).subscribe(i=>{console.log(i),this.isTyping=!0,this.pushMessage(i,"assistant")})}}handleTalkToAdminDone(){let e={type:"continue"};this.chatBotService.interact(e).subscribe(i=>{console.log("Okay ",i),this.isTyping=!0})}handleChoiceSelection(e){let i=[{type:"text",payload:{message:e.name}}];this.pushMessage(i,this.getUserType()),console.log("choice",e),e.request.payload?.actions?e.request.payload?.actions.forEach(r=>{if(r.type==="open_url"){window.open(r.payload.url,"_blank");return}if(r.type==="navigate_url"){if(r.payload.url.startsWith("http://localhost:4200")){let o=new URL(r.payload.url);this.router.navigateByUrl(o.pathname+o.search)}else window.open(r.payload.url,"_blank");return}}):this.chatBotService.interact(e.request).subscribe(r=>{console.log("response choice selection",r),this.isTyping=!0,this.pushMessage(r,"assistant")}),setTimeout(()=>this.scrollToBottom(),100)}handleSelectionCarousel(e){let i=[{type:"text",payload:{message:e.name}}];this.pushMessage(i,this.getUserType()),setTimeout(()=>this.scrollToBottom(),100),this.chatBotService.interact(e.request).subscribe(r=>{console.log("response carousel selection",r),this.isTyping=!0,this.pushMessage(r,"assistant")})}handleCardSelection(e){}endChat(){this.chatBotService.deleteState().subscribe(()=>{this.messages=[],this.isMinimized=!1,this.chatForm.reset(),this.showEndChat=!1,this.socketService.emitToServer(Ae.END_CHAT,{socket_room_name:this.socket_room_name,room_id:this.getRoomID(),reason:"user_left"}),localStorage.removeItem("roomID"),localStorage.removeItem("socket_room_name")})}pushMessage(e,i){let r=i==="user"||i==="guest";e.forEach((o,m)=>{we(o).pipe(J(()=>{r||(this.isTyping=!0)}),fn((o.payload?.delay||500)*(m+1)||2e3)).subscribe(()=>{if(o.type=="text")if(this.isJSON(o.payload.message)){let h=JSON.parse(o.payload.message);console.log("testDataJSON 1",h)}else this.messages.push({type:"text",isUser:r,payload:{text:o.payload.message}});else if(o.type=="choice")console.log("choice"),this.messages.push({type:"choice",isUser:r,payload:{choice:o.payload.buttons}});else if(o.type=="carousel")this.messages.push({type:"carousel",isUser:r,payload:{layout:"carousel",carousel:o.payload.cards}});else if(o.type==="custom_form")this.handleCustomForm(o);else if(o.type==="cardV2")console.log("chat.payload.cardV2",o),this.messages.push({type:"cardV2",isUser:r,payload:{cardV2:[o.payload]}}),console.log("cardV2",this.messages[this.messages.length-1]);else if(o.type==="talk_to_admin"){this.socketService.emitToServer(Ae.CONNECT_ADMIN,{user_id:this.getUserID(),room_id:this.getRoomID()});let h=[{type:"text",payload:{message:"You will be connected to an agent shortly."}}];this.pushMessage(h,"assistant"),this.setIsTalkingWithAD(!0)}if(["text","voice","image","carousel","cardV2","choice","formField"].includes(o.type)){let h="";this.messages.slice(-1)[0].type==="text"?h=this.messages.slice(-1)[0].payload?.text||"":h=JSON.stringify(this.messages.slice(-1)[0].payload[this.messages.slice(-1)[0].type]),this.socketService.emitToServer(Ae.NEW_MESSAGE,{chat_type:o.type,message:h,room_id:this.getRoomID(),user_id:this.getUserID(),socket_room_name:this.socket_room_name,user_type:i,is_read:!1,read_by:[{user_id:this.getUserID()}]})}setTimeout(()=>this.scrollToBottom(),100),this.isTyping=!1})})}onFormSubmit(e){console.log("form",e),this.chatBotService.interact({type:"complete",payload:JSON.stringify(e)}).subscribe(i=>{console.log("response",i),this.isTyping=!0})}handleCustomForm(e){console.log("chat",e),e.payload.type==="add_passenger"&&(this.messages.push({type:"custom_form",isUser:!1,payload:{formField:e.payload.form_structure.passengers[0]}}),console.log("custom_form message",this.messages[this.messages.length-1]))}static{this.\u0275fac=function(i){return new(i||t)(T(ge),T(ci),T(X),T(yi),T(kr),T(Tr),T(Er))}}static{this.\u0275cmp=q({type:t,selectors:[["app-chat-bot"]],viewQuery:function(i,r){i&1&&(Ri(r.chatContainer,Bo,5),Ri(r.scrollContainer,$o,5)),i&2&&En(2)},standalone:!0,features:[Se],decls:3,vars:2,consts:[["scrollContainer",""],[1,"fixed","bottom-4","right-4"],["class","w-12 h-12 rounded-full bg-blue-500 text-white flex items-center justify-center shadow-md hover:bg-blue-600",3,"click",4,"ngIf"],["class","w-[350px] h-[650px] bg-white rounded-lg shadow-md flex flex-col relative",4,"ngIf"],[1,"w-12","h-12","rounded-full","bg-blue-500","text-white","flex","items-center","justify-center","shadow-md","hover:bg-blue-600",3,"click"],[1,"material-symbols-outlined"],[1,"w-[350px]","h-[650px]","bg-white","rounded-lg","shadow-md","flex","flex-col","relative"],[1,"p-4","bg-blue-500","text-white","rounded-t-lg","flex","justify-between","items-center"],[1,"flex","gap-2"],[1,"text-white","hover:text-gray-200",3,"click"],["for","end-chat-drawer",1,"text-white","hover:text-gray-200",3,"click"],[1,"flex-1","p-4","overflow-y-auto"],[3,"ngClass",4,"ngFor","ngForOf"],["class","flex items-center gap-1 p-2",4,"ngIf"],[1,"p-4","border-t",3,"ngSubmit","formGroup"],["type","text","formControlName","message","placeholder","Type your message...",1,"flex-1","p-2","border","rounded-lg","focus:outline-none","focus:border-blue-500"],["type","submit",1,"p-2","bg-blue-500","text-white","rounded-lg","hover:bg-blue-600",3,"disabled"],["class","absolute rounded-lg inset-0 bg-black/50 transition-opacity duration-300",3,"click",4,"ngIf"],["class","absolute bottom-0 left-0 right-0 p-4 bg-white border-t transform transition-all duration-300 ease-out z-10",3,"ngClass",4,"ngIf"],[3,"ngClass"],[1,"flex","flex-wrap","gap-2","my-2"],[1,"carousel","carousel-center","bg-neutral","rounded-box","max-w-md","space-x-4","p-4"],[1,"cardV2","bg-base-100","w-72","shadow-2xl","hover:shadow-3xl","transition-shadow","duration-300"],["class","btn btn-primary btn-sm text-white",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-primary","btn-sm","text-white",3,"click"],["class","carousel-item w-full",3,"id",4,"ngFor","ngForOf"],[1,"carousel-item","w-full",3,"id"],[1,"card","w-96","bg-base-100","shadow-xl"],[3,"src","alt"],[1,"card-body"],[1,"card-title"],[1,"badge","badge-sm",3,"ngClass"],[1,"space-y-2","text-sm"],[1,"whitespace-pre-line",3,"innerHTML"],[1,"card-actions"],[1,"btn","btn-primary","w-full"],[1,"btn","btn-primary","w-full",3,"click"],[1,"px-2","pt-2"],[1,"rounded-xl","h-48","w-full","object-cover","hover:scale-105","transition-transform","duration-300",3,"src","alt"],[1,"cardV2-body","p-6"],[1,"flex","items-center","gap-2"],[1,"cardV2-title","text-xl","font-bold"],[1,"space-y-3","text-sm","mt-2"],[1,"whitespace-pre-line","prose",3,"innerHTML"],[1,"cardV2-actions","mt-4","gap-2"],[1,"btn","btn-primary","w-full","hover:btn-primary-focus","transition-colors","duration-200"],[1,"btn","btn-primary","w-full","hover:btn-primary-focus","transition-colors","duration-200",3,"click"],[3,"formFields"],[3,"formSubmit","formFields"],[1,"flex","items-center","gap-1","p-2"],[1,"w-2","h-2","rounded-full","bg-gray-400","animate-bounce"],[1,"w-2","h-2","rounded-full","bg-gray-400","animate-bounce",2,"animation-delay","0.2s"],[1,"w-2","h-2","rounded-full","bg-gray-400","animate-bounce",2,"animation-delay","0.4s"],[1,"absolute","rounded-lg","inset-0","bg-black/50","transition-opacity","duration-300",3,"click"],[1,"absolute","bottom-0","left-0","right-0","p-4","bg-white","border-t","transform","transition-all","duration-300","ease-out","z-10",3,"ngClass"],[1,"flex","flex-col","gap-2"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","justify-center","flex-col","gap-2","mt-2"],[1,"btn","btn-error","btn-sm","text-white","w-full",3,"click"],[1,"btn","btn-ghost","btn-sm","w-full",3,"click"]],template:function(i,r){i&1&&(a(0,"div",1),g(1,qo,3,0,"button",2)(2,ss,23,7,"div",3),s()),i&2&&(c(),d("ngIf",!r.isMinimized),c(),d("ngIf",r.isMinimized))},dependencies:[Ee,mt,Pe,re,Be,ue,me,de,pe,he,fe,li]})}}return t})();function ls(t,n){t&1&&S(0,"app-chat-bot")}var Fr=(()=>{class t{constructor(e){this.router=e,this.title="fe"}shouldShowChatBot(){let e=this.router.url;return!e.includes("login")&&!e.includes("register")}static{this.\u0275fac=function(i){return new(i||t)(T(X))}}static{this.\u0275cmp=q({type:t,selectors:[["app-root"]],decls:2,vars:1,consts:[[4,"ngIf"]],template:function(i,r){i&1&&(S(0,"router-outlet"),g(1,ls,1,0,"app-chat-bot",0)),i&2&&(c(),d("ngIf",r.shouldShowChatBot()))},dependencies:[re,Vn,xi]})}}return t})();var Ot=ii(en()),Ar=ii(Dr()),Rr=ii(Mr());Ot.default.extend(Rr.default);Ot.default.extend(Ar.default);var Pt=(()=>{class t{constructor(e){this.http=e}generateCalendarRange(e){let i=(0,Ot.default)(),r=(0,Ot.default)(e),o=[],m=i.startOf("month");for(;m.isBefore(r)||m.isSame(r,"month");)o.push({monthYear:m.format("YYYY-MM"),days:this.generateDaysForMonth(m),prevMonthDays:this.generateCalendarObject(m.format("YYYY-MM"))}),m=m.add(1,"month");return o}generateDaysForMonth(e){let i=e.daysInMonth(),r=[];for(let o=1;o<=i;o++){let m=e.date(o);r.push({day:m.format("YYYY-MM-DD"),group:"init",price:0})}return r}mergePriceData(e,i){let r=new Map(i.map(o=>[o.day,o]));return e.map(o=>cn(ti({},o),{days:o.days.map(m=>ti(ti({},m),r.get(m.day)))}))}generateCalendarObject(e){let i=(0,Ot.default)(e),r=i.startOf("month").day(),o=i.subtract(1,"month").daysInMonth();return Array.from({length:r},(u,h)=>o-h).reverse()}searchCalenderPrice(e,i,r){return this.http.get(`${se}/flights/search/price-oneway`,{params:{fromEntityId:e,departDate:i,toEntityId:r}})}searchCalenderPriceReturn(e,i,r,o){return this.http.get(`${se}/flights/search/price-return`,{params:{fromEntityId:e,departDate:i,toEntityId:r,returnDate:o}})}static{this.\u0275fac=function(i){return new(i||t)(z(Ne))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ms=t=>({results:t,field:"from_departure"}),ds=()=>({icon:"flight",label:"One way",cityOrTrip:"trip",flightType:"oneWay"}),ps=()=>({icon:"connecting_airports",label:"Round Trip",cityOrTrip:"trip",flightType:"roundTrip"}),us=()=>({icon:"language",label:"Multi City",cityOrTrip:"city"}),hs=t=>({results:t,field:"to_destination"});function fs(t,n){t&1&&(a(0,"div",43)(1,"button",44),l(2," Login "),s(),a(3,"button",45),l(4," Register "),s()())}function gs(t,n){if(t&1){let e=V();a(0,"div",46)(1,"div",47)(2,"div",48)(3,"div",49)(4,"div",50),S(5,"img",51),s()()(),a(6,"ul",52)(7,"li")(8,"a",53),l(9,"Profile Settings"),s()(),a(10,"li")(11,"a",54),b("click",function(){F(e);let r=p();return D(r.logout())}),l(12,"Logout"),s()()()()()}if(t&2){let e=p();c(5),kn("src",e.avatar,Ze)}}function _s(t,n){t&1&&ze(0)}function vs(t,n){if(t&1&&(a(0,"span",55),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("from_departure")," ")}}function ys(t,n){t&1&&ze(0)}function xs(t,n){t&1&&ze(0)}function bs(t,n){t&1&&ze(0)}function Cs(t,n){t&1&&S(0,"div")}function ws(t,n){if(t&1&&(a(0,"option",56),l(1),s()),t&2){let e=n.$implicit;d("value",e),c(),x(" ",e," ")}}function Ss(t,n){if(t&1&&(a(0,"option",56),l(1),s()),t&2){let e=n.$implicit;d("value",e),c(),x(" ",e," ")}}function ks(t,n){t&1&&ze(0)}function Ts(t,n){if(t&1&&(a(0,"span",55),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("to_destination")," ")}}function Es(t,n){if(t&1){let e=V();a(0,"li",61),b("click",function(){let r=F(e).$implicit,o=p(2).field,m=p();return D(m.selectResult(o,r))}),l(1),s()}if(t&2){let e=n.$implicit;c(),x(" ",e.presentation.title," ")}}function Is(t,n){if(t&1&&(a(0,"div",58)(1,"ul",59),g(2,Es,2,1,"li",60),s()()),t&2){let e=p().results;c(2),d("ngForOf",e)}}function Fs(t,n){if(t&1&&g(0,Is,3,1,"div",57),t&2){let e=n.results;d("ngIf",e&&e.length>0)}}function Ds(t,n){if(t&1&&(a(0,"span",55),l(1),s()),t&2){let e=p(2);c(),x(" ",e.getErrorMessage("date")," ")}}function Ms(t,n){if(t&1){let e=V();a(0,"div",62)(1,"label",63)(2,"div",14)(3,"span",15),l(4,"Departure Date"),s()(),a(5,"div",16),b("clickOutside",function(){F(e);let r=p();return D(r.closeCalendar())}),a(6,"button",64),b("click",function(){F(e);let r=p();return D(r.openCalendar())}),a(7,"span",65),l(8," calendar_month "),s(),a(9,"p"),l(10),ke(11,"weekMonthDay"),s()(),a(12,"app-calendar",66),b("priceDay",function(r){F(e);let o=p();return D(o.priceDayChange(r))}),s()(),a(13,"div",21),g(14,Ds,2,1,"span",22),s()()()}if(t&2){let e,i=p();d("formGroup",i.flightSearchForm),c(6),d("ngClass",i.isCalendarOpen()?"border-blue-400":"border-gray-400"),c(4),x(" ",Te(11,7,i.flightSearchForm.get("depart_date").value)," "),c(2),d("isCalendarOpen",i.isCalendarOpen())("selectedFlightType",i.selectedFlightType)("DepDesCalendar",i.DepDesCalendar()),c(2),d("ngIf",((e=i.flightSearchForm.get("date"))==null?null:e.invalid)&&(((e=i.flightSearchForm.get("date"))==null?null:e.dirty)||((e=i.flightSearchForm.get("date"))==null?null:e.touched)))}}function As(t,n){if(t&1){let e=V();a(0,"div",67)(1,"label",63)(2,"div",68)(3,"span",15),l(4,"Departure Date "),s(),a(5,"span",15),l(6,"Return Date"),s()(),a(7,"div",16),b("clickOutside",function(){F(e);let r=p();return D(r.closeCalendar())}),a(8,"button",69),b("click",function(){F(e);let r=p();return D(r.openCalendar())}),a(9,"div",70)(10,"div",71)(11,"span",72),l(12," calendar_month "),s(),a(13,"p"),l(14),ke(15,"weekMonthDay"),s()()(),S(16,"div",73),a(17,"div",70)(18,"div",71)(19,"span",72),l(20," calendar_month "),s(),a(21,"p"),l(22),ke(23,"weekMonthDay"),s()()()(),a(24,"app-calendar",66),b("priceDay",function(r){F(e);let o=p();return D(o.priceDayChange(r))}),s()()()()}if(t&2){let e=p();d("formGroup",e.flightSearchForm),c(8),d("ngClass",e.isCalendarOpen()?"border-blue-400":"border-gray-400"),c(6),x(" ",Te(15,7,e.flightSearchForm.get("depart_date").value)," "),c(8),x(" ",Te(23,9,e.flightSearchForm.get("return_date").value)," "),c(2),d("isCalendarOpen",e.isCalendarOpen())("selectedFlightType",e.selectedFlightType)("DepDesCalendar",e.DepDesCalendar())}}function Rs(t,n){if(t&1){let e=V();a(0,"button",74),b("click",function(){let r=F(e),o=r.cityOrTrip,m=r.flightType,u=p();return D(o==="trip"?u.selectFlightType(m):u.toggleMultiCity())}),a(1,"div",75)(2,"span",76),l(3),s()(),a(4,"div",77),l(5),s()()}if(t&2){let e=n.icon,i=n.label,r=n.cityOrTrip,o=n.flightType,m=p();d("ngClass",r==="trip"?m.selectedFlightType===o?"flex-col":"flex-col-reverse":m.selectedMultiCity?"flex-col":"flex-col-reverse"),c(),d("ngClass",r==="trip"?m.selectedFlightType===o?"bg-[#97C1CE]":"bg-white":m.selectedMultiCity?"bg-[#97C1CE]":"bg-white"),c(),d("ngClass",r==="trip"?m.selectedFlightType===o?"text-white":"":m.selectedMultiCity?"text-white":""),c(),x(" ",e," "),c(2),N(i)}}var bi=(()=>{class t{constructor(e,i,r,o,m,u,h){this._fb=e,this._flightServiceAPI=i,this.router=r,this.cdr=o,this.calendarService=m,this.userService=u,this.tokenService=h,this.formSubmit$=new ne,this.destroy$=new ne,this.fromResults=[],this.toResults=[],this.selectedFlightType="oneWay",this.selectedMultiCity=!1,this.selectedClassType=["Economy","Premium Economy","Business","First"],this.selectedTravellerType=["Adult","Children","Infant","Senior","Student"],this.isCalendarOpen=ae(!1),this.DepDesCalendar=ae({from:"",to:""}),this.isLoggedIn=!1,this.avatar=""}ngOnInit(){this.initForm(),this.setupAutocomplete(),this.selectFlightType("oneWay"),this.formSubmit$.pipe(J(()=>this.flightSearchForm.markAsDirty()),Z(()=>Ve(this.flightSearchForm)),De(e=>(console.log(e),e)),Me(this.destroy$)).subscribe(()=>this.submitForm()),this.checkAuth()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}checkAuth(){localStorage.getItem("userEmail")?(this.isLoggedIn=!0,this.avatar=localStorage.getItem("avatar")||"https://static-00.iconduck.com/assets.00/avatar-default-icon-2048x2048-h6w375ur.png"):this.isLoggedIn=!1}initForm(){this.flightSearchForm=this._fb.group({from_departure:["",[w.required,w.minLength(3)]],from_departure_skyID:[""],to_destination:["",[w.required,w.minLength(3)]],to_destination_skyID:[""],depart_date:[new Date().toISOString(),[w.required]],return_date:[new Date().toISOString(),[w.required]],class_type:["Economy"],traveller_type:["Adult"]},{validator:this.differentDestinationsValidator})}submitForm(){let e=this.flightSearchForm.get("from_departure_skyID").value,i=this.flightSearchForm.get("to_destination_skyID").value,r=this.flightSearchForm.get("from_departure").value,o=this.flightSearchForm.get("to_destination").value,m=this.flightSearchForm.get("class_type").value,u=this.flightSearchForm.get("traveller_type").value,h=this.flightSearchForm.get("depart_date").value;if(this.selectedFlightType==="oneWay")this.router.navigate(["/flight"],{queryParams:{from_departure_id:e,to_destination_id:i,from_departure:r,to_destination:o,depart_date:h,class_type:m,traveller_type:u}});else{let _=this.flightSearchForm.get("return_date").value;this.router.navigate(["/flight"],{queryParams:{from_departure_id:e,to_destination_id:i,from_departure:r,to_destination:o,depart_date:h,return_date:_,class_type:m,traveller_type:u}})}}setupAutocomplete(){this.setupFieldAutocomplete("from_departure"),this.setupFieldAutocomplete("to_destination")}setupFieldAutocomplete(e){this.flightSearchForm.get(e).valueChanges.pipe(hn(300),gn(),J(i=>{i.length<3&&(this[e==="from_departure"?"fromResults":"toResults"]=[])}),De(i=>i.length>=3),Z(i=>{let r=i.replace(/\s+/g,"-").toLowerCase();return this._flightServiceAPI.getLocations(r).pipe(Le(o=>(console.error(`Error fetching ${e} locations:`,o),we({data:[]}))))}),Me(this.destroy$)).subscribe(i=>{let r=e==="from_departure"?"fromResults":"toResults";this[r]=i.data.length>0?i.data:[{presentation:{title:"No data found"}}],console.log(`${e} results:`,this[r])})}selectResult(e,i){let r=this.flightSearchForm.get(e),o=this.flightSearchForm.get(`${e}_skyID`);if(r.setValue(i.presentation.title,{emitEvent:!1}),o.setValue(i.navigation.relevantFlightParams.skyId,{emitEvent:!1}),e==="to_destination"){let m=this.flightSearchForm.get("from_departure_skyID").value,u=this.flightSearchForm.get("to_destination_skyID").value;console.log("from_departure_skyID",m),console.log("to_destination_skyID",u),this.DepDesCalendar.set({from:m,to:u}),console.log("DepDesCalendar",this.DepDesCalendar())}e==="from_departure"?this.fromResults=[]:this.toResults=[],console.log(o.value)}selectFlightType(e){if(this.selectedFlightType=e,e==="oneWay"){let i=this.flightSearchForm.get("return_date");i?.clearValidators(),i?.setValue("")}else{let i=this.flightSearchForm.get("depart_date"),r=this.flightSearchForm.get("return_date");i?.setValidators([w.required]),r?.setValidators([w.required])}this.flightSearchForm.updateValueAndValidity(),this.cdr.detectChanges()}toggleMultiCity(){this.selectedMultiCity=!this.selectedMultiCity}openCalendar(){this.isCalendarOpen.set(!this.isCalendarOpen())}closeCalendar(){this.isCalendarOpen.set(!1)}closeAutoComplete(){this.fromResults=[],this.toResults=[]}onInputClick(e,i){console.log("Input clicked");let r=e.target.value;if(r){let o=r.replace(/\s+/g,"-").toLowerCase();this._flightServiceAPI.getLocations(o).pipe(Le(m=>(console.error("Error fetching locations:",m),we({data:[]})))).subscribe(m=>{let u=i==="from_departure"?"fromResults":"toResults";console.log("results",m),this[u]=m.data.length>0?m.data:[{presentation:{title:"No data found"}}],console.log(`${i} results:`,this[u])})}}priceDayChange(e){console.log("day",e);let i=e.departure,r=e.return;this.selectedFlightType==="oneWay"?this.flightSearchForm.get("depart_date")?.setValue(i):(this.flightSearchForm.get("depart_date")?.setValue(i),this.flightSearchForm.get("return_date")?.setValue(r)),this.isCalendarOpen.set(!1)}logout(){let e=this.tokenService.getAccessToken(),i;e&&(i=JSON.parse(atob(e.split(".")[1])));let r=i.email;console.log(i),this.userService.logout(r).pipe(J(()=>{this.tokenService.clearTokens(),localStorage.clear(),window.location.reload()})).subscribe()}differentDestinationsValidator(e){let i=e.get("from_departure")?.value,r=e.get("to_destination")?.value;return i&&r&&i.toLowerCase()===r.toLowerCase()?{sameDestinations:!0}:null}getErrorMessage(e){let i=this.flightSearchForm.get(e);if(i?.errors&&Object.keys(i?.errors).length>0){if(i.errors.required)return"This field is required";if(i.errors.minlength)return"This field must be at least 3 characters long";if(i.errors.pastDate)return"Please select a future date";if(i.errors.sameDestinations)return"From and To destinations cannot be the same"}return""}static{this.\u0275fac=function(i){return new(i||t)(T(ge),T(It),T(X),T(Fn),T(Pt),T(dt),T($e))}}static{this.\u0275cmp=q({type:t,selectors:[["app-home-page"]],decls:74,vars:28,consts:[["autocompleteTemplate",""],["oneWayCalendar",""],["roundTripCalendar",""],["TripOrCityTemplate",""],[1,"w-full","h-screen","relative","flex","flex-col","items-center","justify-center","bg-slate-200"],[1,"fixed","top-0","w-full","bg-white","shadow-md","z-50"],[1,"flex","items-center","justify-between","w-full","h-16","px-10"],[1,"text-2xl","font-bold","text-blue-600"],["class","flex gap-4",4,"ngIf"],["class","flex items-center gap-4",4,"ngIf"],["ngSrc","https://cdn.builder.io/api/v1/image/assets/TEMP/f7b6b2931a5ba543da034a16e2dcc32321625dcb98cef54c0d19c43197e5314e?apiKey=6b158420ea1148c682b1835c67783cca&","priority","","alt","","fill",""],["autocomplete","off",1,"flex","relative","flex-row","gap-10","justify-center","m-auto",3,"ngSubmit","formGroup"],[1,"flex","flex-col","self-stretch","my-auto","text-black","whitespace-nowrap","w-[252px]"],[1,"row-control"],[1,"label","flex","gap-2","justify-start"],[1,"label-text"],["clickOutside","",3,"clickOutside"],[1,"input","input-bordered","flex","items-center","gap-2"],[1,"material-symbols-outlined"],["type","text","placeholder","Ha Noi","id","from_departure","formControlName","from_departure","name","from_departure","required","",1,"grow",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"label"],["class","error-message label-text-alt text-red-600",4,"ngIf"],[1,"flex","flex-col","p-2","mt-7","text-lg","bg-white","rounded-xl","h-[171px]","w-[171px]"],["ngSrc","https://cdn.builder.io/api/v1/image/assets/TEMP/d4438f2f2f0d4e1b80b2a07ec4bc458cd606a527405112f27a29a1b4bc9eda8e?apiKey=6b158420ea1148c682b1835c67783cca&","alt","Hanoi cityscape","priority","","width","157","height","120"],[1,"mt-2.5"],[1,"flex","relative","gap-2.5","justify-center","items-start","self-stretch","px-12","py-20","my-auto","min-h-[591px]","min-w-[240px]","max-md:px-5","max-md:max-w-full"],["ngSrc","https://cdn.builder.io/api/v1/image/assets/TEMP/3dd1ba8dd670d19287ef667409c5adca6a3fd1f7e65741a52893e3082a10a766?apiKey=6b158420ea1148c682b1835c67783cca&","alt","","priority","","width","478","height","591",1,"absolute","top-2/4","left-2/4","z-0","self-start","-translate-x-2/4","-translate-y-2/4","min-w-[240px]","max-md:max-w-full"],[1,"flex","z-0","flex-col","my-auto","min-w-[240px]","w-[400px]"],[1,"flex","gap-10","items-center","self-center"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"flex","items-center","justify-around","px-4","mt-3.5","w-full","bg-white","rounded-xl","min-h-[95px]"],[1,"flex","flex-col","my-auto","w-5/12"],["for","classSelect",1,"text-base","text-black","text-opacity-60"],["id","classSelect","formControlName","class_type","name","class_type",1,"select","select-bordered","w-full"],[3,"value",4,"ngFor","ngForOf"],[1,"divider","divider-horizontal","w-1/6"],["for","travellerSelect",1,"text-base","text-black","text-opacity-60"],["id","travellerSelect","formControlName","traveller_type","name","traveller_type",1,"select","select-bordered","w-full"],["aria-label","Search flights","type","submit",1,"flex","gap-2.5","items-center","self-center","p-5","mt-3.5","bg-slate-400","h-[60px]","min-h-[60px]","rounded-[30px]","w-[60px]",3,"disabled"],[1,"material-symbols-outlined","text-white"],["type","text","placeholder","New york city","id","to_destination","formControlName","to_destination","name","to_destination","required","",1,"grow"],["ngSrc","https://cdn.builder.io/api/v1/image/assets/TEMP/6655cded37a0d184135bb1e86f283624fb3cd1f0647a52aa9b399fbe088591a1?apiKey=6b158420ea1148c682b1835c67783cca&","priority","","width","157","height","120","alt","Singapore cityscape",1,"rounded-xl"],[1,"flex","gap-4"],["routerLink","/login",1,"px-4","py-2","text-blue-600","hover:text-blue-700"],["routerLink","/register",1,"px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700"],[1,"flex","items-center","gap-4"],[1,"dropdown","dropdown-end"],["tabindex","0",1,"flex","items-center","gap-2","cursor-pointer"],[1,"avatar"],[1,"w-10","rounded-full"],["alt","Profile",3,"src"],["tabindex","0",1,"dropdown-content","menu","p-2","shadow","bg-base-100","rounded-box","w-52"],["routerLink","/account"],[3,"click"],[1,"error-message","label-text-alt","text-red-600"],[3,"value"],["class","absolute z-10 w-[252px] bg-white shadow-lg rounded-md",4,"ngIf"],[1,"absolute","z-10","w-[252px]","bg-white","shadow-lg","rounded-md"],[1,"py-1"],["class","px-4 py-2 hover:bg-gray-100 cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"px-4","py-2","hover:bg-gray-100","cursor-pointer",3,"click"],[1,"flex","items-center","justify-center","px-4","mt-3.5","w-full","bg-white","rounded-xl","min-h-[95px]",3,"formGroup"],[1,"form-control","w-full","max-w-xs"],["type","button",1,"flex","items-center","gap-2","w-full","h-12","border-2","rounded-md",3,"click","ngClass"],[1,"material-symbols-outlined","ml-2"],[3,"priceDay","isCalendarOpen","selectedFlightType","DepDesCalendar"],[1,"flex","items-center","justify-center","px-4","mt-3.5","pb-3.5","w-full","bg-white","rounded-xl","min-h-[95px]",3,"formGroup"],[1,"label","flex","gap-2","justify-between"],["type","button",1,"flex","items-center","justify-between","gap-2","w-full","h-12","border-2","rounded-md",3,"click","ngClass"],[1,"w-full"],[1,"flex","items-center","justify-start","gap-2"],[1,"material-symbols-outlined","ml-1"],[1,"h-full","w-0.5","bg-gray-400"],["type","button",1,"flex","gap-2","items-center","self-stretch","px-1.5","pt-1.5","pb-1.5","my-auto","bg-white","min-h-[142px]","rounded-[100px]","w-[78px]",3,"click","ngClass"],["aria-label","Select multi-city flight",1,"flex","gap-2.5","items-center","justify-center","border","border-solid","border-stone-300","h-[66px]","min-h-[66px]","rounded-[33px]","shadow-[0px_4px_4px_rgba(0,0,0,0.25)]","w-[66px]","max-md:pl-5",3,"ngClass"],[1,"material-symbols-outlined",3,"ngClass"],[1,"mt-1.5","text-xl","text-center","text-black"]],template:function(i,r){if(i&1){let o=V();a(0,"div",4)(1,"div",5)(2,"nav",6)(3,"div",7),l(4,"FlightBooking"),s(),g(5,fs,5,0,"div",8)(6,gs,13,1,"div",9),s()(),S(7,"img",10),a(8,"form",11),b("ngSubmit",function(){return F(o),D(r.submitForm())}),a(9,"section",12)(10,"div",13)(11,"div",14)(12,"span",15),l(13,"Depature"),s()(),a(14,"div",16),b("clickOutside",function(){return F(o),D(r.closeAutoComplete())}),a(15,"label",17)(16,"span",18),l(17," flight_takeoff "),s(),a(18,"input",19),b("click",function(u){return F(o),D(r.onInputClick(u,"from_departure"))}),s()(),g(19,_s,1,0,"ng-container",20),s(),a(20,"div",21),g(21,vs,2,1,"span",22),s()(),a(22,"figure",23),S(23,"img",24),a(24,"figcaption",25),l(25,"Hanoi"),s()()(),a(26,"div",26),S(27,"img",27),a(28,"div",28)(29,"div",29),g(30,ys,1,0,"ng-container",20)(31,xs,1,0,"ng-container",20)(32,bs,1,0,"ng-container",20),s(),g(33,Cs,1,0,"div",30),a(34,"div",31)(35,"div",32)(36,"label",33),l(37,"Class"),s(),a(38,"select",34),g(39,ws,2,2,"option",35),s()(),S(40,"div",36),a(41,"div",32)(42,"label",37),l(43,"Traveller"),s(),a(44,"select",38),g(45,Ss,2,2,"option",35),s()()(),a(46,"button",39)(47,"span",40),l(48," search "),s()()()(),a(49,"section",12)(50,"div",13)(51,"div",14)(52,"span",15),l(53,"Arrival"),s()(),a(54,"div",16),b("clickOutside",function(){return F(o),D(r.closeAutoComplete())}),a(55,"label",17)(56,"span",18),l(57," flight_land "),s(),S(58,"input",41),s(),g(59,ks,1,0,"ng-container",20),s(),a(60,"div",21),g(61,Ts,2,1,"span",22),s()(),a(62,"figure",23),S(63,"img",42),a(64,"figcaption",25),l(65,"Singapore"),s()()()()(),g(66,Fs,1,1,"ng-template",null,0,ct)(68,Ms,15,9,"ng-template",null,1,ct)(70,As,25,11,"ng-template",null,2,ct)(72,Rs,6,5,"ng-template",null,3,ct)}if(i&2){let o,m,u=et(67),h=et(69),_=et(71),C=et(73);c(5),d("ngIf",!r.isLoggedIn),c(),d("ngIf",r.isLoggedIn),c(2),d("formGroup",r.flightSearchForm),c(11),d("ngTemplateOutlet",u)("ngTemplateOutletContext",tt(21,ms,r.fromResults)),c(2),d("ngIf",((o=r.flightSearchForm.get("from_departure"))==null?null:o.invalid)&&(((o=r.flightSearchForm.get("from_departure"))==null?null:o.dirty)||((o=r.flightSearchForm.get("from_departure"))==null?null:o.touched))),c(9),d("ngTemplateOutlet",C)("ngTemplateOutletContext",Ct(23,ds)),c(),d("ngTemplateOutlet",C)("ngTemplateOutletContext",Ct(24,ps)),c(),d("ngTemplateOutlet",C)("ngTemplateOutletContext",Ct(25,us)),c(),d("ngIf",r.selectedFlightType=="oneWay")("ngIfThen",h)("ngIfElse",_),c(6),d("ngForOf",r.selectedClassType),c(6),d("ngForOf",r.selectedTravellerType),c(),d("disabled",r.flightSearchForm.invalid),c(13),d("ngTemplateOutlet",u)("ngTemplateOutletContext",tt(26,hs,r.toResults)),c(2),d("ngIf",((m=r.flightSearchForm.get("to_destination"))==null?null:m.invalid)&&(((m=r.flightSearchForm.get("to_destination"))==null?null:m.dirty)||((m=r.flightSearchForm.get("to_destination"))==null?null:m.touched)))}}})}}return t})();var ft=/^(?=.*[!@#$%^&*]+)[a-z0-9!@#$%^&*]{6,32}$/,Nt=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/;function Os(t,n){if(t&1&&(a(0,"span",14),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("newPassword")," ")}}function Ps(t,n){if(t&1&&(a(0,"span",14),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("confirmNewPassword")," ")}}var Nr=(()=>{class t{constructor(e,i,r,o){this._fb=e,this.authService=i,this.router=r,this.route=o,this.formSubmit$=new ne,this.destroy$=new ne,this.email$="",this.tempAccessToken=""}ngOnInit(){this.validate_token(),this.initForm(),this.formSubmit$.pipe(J(()=>this.passwordResetForm.markAsDirty()),Z(()=>Ve(this.passwordResetForm)),De(e=>e),Me(this.destroy$)).subscribe(()=>this.submitForm())}validate_token(){this.route.queryParams.subscribe(e=>{let i=e.token;this.email$=e.email,i&&this.email$?this.authService.validateToken(i).subscribe(r=>{console.log(r),this.tempAccessToken=r.tempAccessToken},r=>{console.error("Token is invalid"),this.router.navigate(["/**"])}):this.router.navigate(["/**"])})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}submitForm(){console.log("Submit form");let e=this.passwordResetForm.value.newPassword;this.authService.resetPassword(this.tempAccessToken,e).subscribe(i=>{i.user&&(console.log("Password reset successfully"),this.router.navigate(["/login"]))},i=>{console.error("Error resetting password:",i)})}initForm(){this.passwordResetForm=this._fb.group({newPassword:["",w.compose([w.required,w.minLength(6),w.pattern(ft)])],confirmNewPassword:["",w.compose([w.required,w.minLength(6),w.pattern(ft)])]},{validators:this.validateControlsValue("password","confirmPassword")})}validateControlsValue(e,i){return function(r){let o=r.get(e),m=r.get(i),u=o?.value,h=m?.value;return u===h?null:{valueNotMatch:{firstControlValue:u,secondControlValue:h}}}}getErrorMessage(e){let i=this.passwordResetForm.get(e);if(i?.errors){if(i.hasError("required"))return"This field is required";if(i.hasError("minlength"))return"Password must be at least 6 characters long";if(i.hasError("pattern"))return"Password must contain at least one uppercase letter, one lowercase letter, one digit, and one special character";if(i.hasError("valueNotMatch"))return"Passwords do not match"}return""}static{this.\u0275fac=function(i){return new(i||t)(T(ge),T(Ge),T(X),T(St))}}static{this.\u0275cmp=q({type:t,selectors:[["app-password-reset"]],decls:24,vars:4,consts:[[1,"container","w-full","h-screen","flex","mx-auto","justify-center","items-center"],["autocomplete","off",1,"password-reset-form",3,"formGroup"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-blue-600","to-purple-600","bg-clip-text","text-transparent"],[1,"row-control"],[1,"form-control","w-full","max-w-xl"],[1,"label"],["for","newPassword",1,"label-text"],["type","password","id","newPassword","name","newPassword","placeholder","Enter new password","formControlName","newPassword","required","",1,"input","input-bordered","w-full","max-w-xl"],["class","error-message label-text-alt text-red-600",4,"ngIf"],["for","confirmNewPassword",1,"label-text"],["type","password","id","confirmNewPassword","name","confirmNewPassword","placeholder","Confirm new password","formControlName","confirmNewPassword","required","",1,"input","input-bordered","w-full","max-w-xl"],[1,"row-control","row-actions"],["type","submit",1,"btn","btn-primary","w-full",3,"click","disabled"],[1,"error-message","label-text-alt","text-red-600"]],template:function(i,r){if(i&1&&(a(0,"div",0)(1,"form",1)(2,"div",2)(3,"h2",3),l(4," Reset password "),s()(),a(5,"div",4)(6,"label",5)(7,"div",6)(8,"span",7),l(9,"New Password"),s()(),S(10,"input",8),a(11,"div",6),g(12,Os,2,1,"span",9),s()()(),a(13,"div",4)(14,"label",5)(15,"div",6)(16,"span",10),l(17,"Confirm New Password"),s()(),S(18,"input",11),a(19,"div",6),g(20,Ps,2,1,"span",9),s()()(),a(21,"div",12)(22,"button",13),b("click",function(){return r.submitForm()}),l(23," Reset Password "),s()()()()),i&2){let o,m;c(),d("formGroup",r.passwordResetForm),c(11),d("ngIf",((o=r.passwordResetForm.get("newPassword"))==null?null:o.invalid)&&(((o=r.passwordResetForm.get("newPassword"))==null?null:o.dirty)||((o=r.passwordResetForm.get("newPassword"))==null?null:o.touched))),c(8),d("ngIf",((m=r.passwordResetForm.get("confirmNewPassword"))==null?null:m.invalid)&&(((m=r.passwordResetForm.get("confirmNewPassword"))==null?null:m.dirty)||((m=r.passwordResetForm.get("confirmNewPassword"))==null?null:m.touched))),c(2),d("disabled",r.passwordResetForm.invalid)}},dependencies:[ue,me,de,pe,We,re,he,fe]})}}return t})();function Ns(t,n){if(t&1&&(a(0,"span",15),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("email")," ")}}function Bs(t,n){if(t&1&&(a(0,"span",15),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("password")," ")}}function $s(t,n){if(t&1&&(a(0,"span",15),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("confirmPassword")," ")}}var Bt=(()=>{class t{constructor(e,i){this._fb=e,this.userService=i,this.formSubmit$=new ne,this.destroy$=new ne,this.isAuthChanged=lt()}ngOnInit(){this.initForm(),this.formSubmit$.pipe(J(()=>this.registerForm.markAsDirty()),Z(()=>Ve(this.registerForm)),De(e=>e),Me(this.destroy$)).subscribe(()=>this.submitForm())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}submitForm(){console.log("Submit form");let e=this.registerForm.value.email,i=this.registerForm.value.password,r={email:e,password:i};this.userService.register(r).subscribe(()=>{this.isAuthChanged.emit(!0)})}initForm(){this.registerForm=this._fb.group({email:["",w.compose([w.required,w.pattern(Nt)]),this.validateEmailFromAPIDebounce.bind(this)],password:["",w.compose([w.required,w.minLength(6),w.pattern(ft)])],confirmPassword:["",w.compose([w.required,w.minLength(6),w.pattern(ft)])]},{validators:this.validateControlsValue("password","confirmPassword")})}validateControlsValue(e,i){return function(r){let o=r.get(e),m=r.get(i),u=o?.value,h=m?.value;return u===h?null:{valueNotMatch:{firstControlValue:u,secondControlValue:h}}}}validateEmailFromAPIDebounce(e){return un(300).pipe(Z(()=>(console.log(e.value),this.userService.validateEmail(e.value).pipe(Qe(i=>i?{emailDuplicated:!0}:null)))))}getErrorMessage(e){let i=this.registerForm.get(e);if(i?.errors){if(i.errors.required)return"This field is required";if(i.errors.minlength)return`Minimum length is ${i.errors.minlength.requiredLength} characters`;if(i.errors.pattern)return"Invalid format";if(i.errors.emailDuplicated)return"Email is already taken";if(e==="confirmPassword"&&i.errors.valueNotMatch)return"Passwords do not match"}return""}static{this.\u0275fac=function(i){return new(i||t)(T(ge),T(dt))}}static{this.\u0275cmp=q({type:t,selectors:[["app-register"]],outputs:{isAuthChanged:"isAuthChanged"},standalone:!0,features:[Se],decls:31,vars:5,consts:[["autocomplete","off",1,"register-form","min-w-80",3,"formGroup"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-blue-600","to-purple-600","bg-clip-text","text-transparent"],[1,"row-control"],[1,"form-control","w-full","max-w-xs"],[1,"label"],[1,"label-text"],["type","email","placeholder","Type here","id","email","formControlName","email","name","email","required","",1,"input","input-bordered","w-full","max-w-xs"],["class","error-message label-text-alt text-red-600",4,"ngIf"],["for","password",1,"label-text"],["type","password","id","password","name","password","placeholder","Password","formControlName","password","required","",1,"input","input-bordered","w-full","max-w-xs"],["for","confirmPassword",1,"label-text"],["type","password","id","confirmPassword","name","confirmPassword","placeholder","Confirm Password","formControlName","confirmPassword","required","",1,"input","input-bordered","w-full","max-w-xs"],[1,"row-control","row-actions","mt-2"],["type","submit",1,"btn","btn-primary","w-full",3,"click","disabled"],[1,"error-message","label-text-alt","text-red-600"]],template:function(i,r){if(i&1&&(a(0,"form",0)(1,"div",1)(2,"h2",2),l(3," Create Your Account "),s()(),a(4,"div",3)(5,"label",4)(6,"div",5)(7,"span",6),l(8,"Email"),s()(),S(9,"input",7),a(10,"div",5),g(11,Ns,2,1,"span",8),s()()(),a(12,"div",3)(13,"label",4)(14,"div",5)(15,"span",9),l(16,"Password"),s()(),S(17,"input",10),a(18,"div",5),g(19,Bs,2,1,"span",8),s()()(),a(20,"div",3)(21,"label",4)(22,"div",5)(23,"span",11),l(24,"Confirm Password"),s()(),S(25,"input",12),a(26,"div",5),g(27,$s,2,1,"span",8),s()()(),a(28,"div",13)(29,"button",14),b("click",function(){return r.submitForm()}),l(30," Register "),s()()()),i&2){let o,m,u;d("formGroup",r.registerForm),c(11),d("ngIf",((o=r.registerForm.get("email"))==null?null:o.invalid)&&(((o=r.registerForm.get("email"))==null?null:o.dirty)||((o=r.registerForm.get("email"))==null?null:o.touched))),c(8),d("ngIf",((m=r.registerForm.get("password"))==null?null:m.invalid)&&(((m=r.registerForm.get("password"))==null?null:m.dirty)||((m=r.registerForm.get("password"))==null?null:m.touched))),c(8),d("ngIf",((u=r.registerForm.get("confirmPassword"))==null?null:u.invalid)&&(((u=r.registerForm.get("confirmPassword"))==null?null:u.dirty)||((u=r.registerForm.get("confirmPassword"))==null?null:u.touched))),c(2),d("disabled",r.registerForm.invalid)}},dependencies:[Ee,re,Be,ue,me,de,pe,We,he,fe]})}}return t})();var Br=(()=>{class t{constructor(e,i,r){this.tokenService=e,this.authService=i,this.router=r}intercept(e,i){return console.log("AuthInterceptor"),i.handle(e).pipe(Le(r=>r.status===401&&this.authService.isTokenExpired()?(console.log("Token expired, refreshing..."),this.authService.refreshToken().pipe(Z(o=>{this.tokenService.setAccessToken(o.accessToken);let m=e.clone({headers:e.headers.set("Authorization",`Bearer ${o.accessToken}`)});return i.handle(m)}))):yt(()=>r)))}static{this.\u0275fac=function(i){return new(i||t)(z($e),z(Ge),z(X))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac})}}return t})();function Ls(t,n){t&1&&S(0,"span",15)}function js(t,n){if(t&1&&(a(0,"div",16)(1,"span"),l(2),s()()),t&2){let e=n.$implicit;c(2),N(e)}}function Us(t,n){if(t&1&&(a(0,"div",17)(1,"span"),l(2),s()()),t&2){let e=n.$implicit;c(2),N(e)}}var $r=(()=>{class t{constructor(e,i,r){this._fb=e,this.router=i,this.authService=r,this.formSubmit$=new ne,this.destroy$=new ne,this.successMessages=[],this.errorMessages=[]}ngOnInit(){this.initForm(),this.formSubmit$.pipe(J(()=>this.emailResetPasswordForm.markAsDirty()),Z(()=>Ve(this.emailResetPasswordForm)),De(e=>e),Me(this.destroy$)).subscribe(()=>this.submitForm())}initForm(){this.emailResetPasswordForm=this._fb.group({email:["",[w.required,w.pattern(Nt),w.maxLength(50)]]})}submitForm(){console.log("Submit form");let e=this.emailResetPasswordForm.value.email;this.authService.sendEmailResetPassword(e).subscribe(i=>{i.status===200&&(console.log("Success:",i.message),this.showSuccessToast("Email sent successfully"))},i=>{console.error("Error:",i),this.showErrorToast("Failed to send email. Please try again.")})}showSuccessToast(e){this.successMessages.push(e),setTimeout(()=>{this.successMessages.pop()},3e3)}showErrorToast(e){this.errorMessages.push(e),setTimeout(()=>{this.errorMessages.pop()},3e3)}static{this.\u0275fac=function(i){return new(i||t)(T(ge),T(X),T(Ge))}}static{this.\u0275cmp=q({type:t,selectors:[["app-email-reset-password"]],decls:19,vars:5,consts:[[1,"container","w-full","h-screen","flex","mx-auto","justify-center","items-center"],["autocomplete","off",1,"register-form","min-w-80",3,"formGroup"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-blue-600","to-purple-600","bg-clip-text","text-transparent"],[1,"row-control"],[1,"form-control","w-full","max-w-xs"],[1,"label"],[1,"label-text"],["type","email","placeholder","Type here","id","email","formControlName","email","name","email","required","",1,"input","input-bordered","w-full","max-w-xs"],["class","error-message label-text-alt text-red-600",4,"ngIf"],[1,"row-control","row-actions"],["type","submit",1,"btn","btn-primary","w-full",3,"click","disabled"],[1,"toast","toast-top","toast-end"],["class","alert alert-success",4,"ngFor","ngForOf"],["class","alert alert-error",4,"ngFor","ngForOf"],[1,"error-message","label-text-alt","text-red-600"],[1,"alert","alert-success"],[1,"alert","alert-error"]],template:function(i,r){if(i&1&&(a(0,"div",0)(1,"form",1)(2,"div",2)(3,"h2",3),l(4," Reset password "),s()(),a(5,"div",4)(6,"label",5)(7,"div",6)(8,"span",7),l(9,"Email"),s()(),S(10,"input",8),a(11,"div",6),g(12,Ls,1,0,"span",9),s()()(),a(13,"div",10)(14,"button",11),b("click",function(){return r.submitForm()}),l(15," Submit "),s()()(),a(16,"div",12),g(17,js,3,1,"div",13)(18,Us,3,1,"div",14),s()()),i&2){let o;c(),d("formGroup",r.emailResetPasswordForm),c(11),d("ngIf",((o=r.emailResetPasswordForm.get("email"))==null?null:o.invalid)&&(((o=r.emailResetPasswordForm.get("email"))==null?null:o.dirty)||((o=r.emailResetPasswordForm.get("email"))==null?null:o.touched))),c(2),d("disabled",r.emailResetPasswordForm.invalid),c(3),d("ngForOf",r.successMessages),c(),d("ngForOf",r.errorMessages)}},dependencies:[ue,me,de,pe,We,Pe,re,he,fe]})}}return t})();var Vr=(()=>{class t{constructor(){}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=q({type:t,selectors:[["app-not-found"]],decls:2,vars:0,template:function(i,r){i&1&&(a(0,"p"),l(1,` not-found works!
`),s())}})}}return t})();var Lr=(()=>{class t{constructor(){}intercept(e,i){return i.handle(e).pipe(Le(r=>(console.error("error occurred:",r),yt(r))))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac})}}return t})();function qs(t,n){if(t&1&&(a(0,"span",13),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("email")," ")}}function Hs(t,n){if(t&1&&(a(0,"span",13),l(1),s()),t&2){let e=p();c(),x(" ",e.getErrorMessage("password")," ")}}function Ys(t,n){if(t&1&&(a(0,"span",13),l(1),s()),t&2){let e=p();c(),x(" ",e.getCommonError()," ")}}var $t=(()=>{class t{constructor(e,i,r,o){this._fb=e,this.userService=i,this.tokenService=r,this.timezoneService=o,this.formSubmit$=new ne,this.commonError="",this.destroy$=new ne,this.isAuth=!1,this.isAuthChanged=lt()}ngOnInit(){this.initForm(),this.formSubmit$.pipe(J(()=>this.loginForm.markAsDirty()),Z(()=>Ve(this.loginForm)),De(e=>e),Me(this.destroy$)).subscribe(()=>this.submitForm())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}submitForm(){console.log("Submit form");let e=this.loginForm.value.email,i=this.loginForm.value.password,r={email:e,password:i};this.userService.login(r).pipe(Qe(o=>{console.log(o),o.accessToken&&o.role&&o.timezone&&(localStorage.setItem("userEmail",o.email),o.avatar,localStorage.setItem("avatar",o.avatar),this.tokenService.setAccessToken(o.accessToken),this.timezoneService.setTimezone(o.timezone),console.log("Login successful"),this.isAuth=!0,this.isAuthChanged.emit(this.isAuth))}),Le(o=>(console.log(o),this.setCommonError("Incorrect username or password"),we(null)))).subscribe()}getCommonError(){return this.commonError}setCommonError(e){this.commonError=e}initForm(){this.loginForm=this._fb.group({email:["",w.compose([w.required,w.pattern(Nt)])],password:["",w.compose([w.required,w.minLength(6),w.pattern(ft)])]})}getErrorMessage(e){let i=this.loginForm.get(e);if(i?.errors){if(i.errors.required)return"This field is required";if(i.errors.minlength)return`Minimum length is ${i.errors.minlength.requiredLength} characters`;if(i.errors.pattern)return"Invalid format"}return""}static{this.\u0275fac=function(i){return new(i||t)(T(ge),T(dt),T($e),T(Hn))}}static{this.\u0275cmp=q({type:t,selectors:[["app-login"]],outputs:{isAuthChanged:"isAuthChanged"},standalone:!0,features:[Se],decls:25,vars:5,consts:[["autocomplete","off",1,"register-form","min-w-80",3,"formGroup"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-blue-600","to-purple-600","bg-clip-text","text-transparent"],[1,"row-control"],[1,"form-control","w-full","min-w-80"],[1,"label"],[1,"label-text"],["type","email","placeholder","Type here","id","email","formControlName","email","name","email","required","",1,"input","input-bordered","w-full","min-w-80"],["class","error-message label-text-alt text-red-600",4,"ngIf"],["for","password",1,"label-text"],["type","password","id","password","name","password","placeholder","Password","formControlName","password","required","",1,"input","input-bordered","w-full","min-w-80"],[1,"row-control","row-actions"],["type","submit",1,"btn","btn-primary","w-full",3,"click","disabled"],[1,"error-message","label-text-alt","text-red-600"]],template:function(i,r){if(i&1&&(a(0,"form",0)(1,"div",1)(2,"h2",2),l(3," Login "),s()(),a(4,"div",3)(5,"label",4)(6,"div",5)(7,"span",6),l(8,"Email"),s()(),S(9,"input",7),a(10,"div",5),g(11,qs,2,1,"span",8),s()()(),a(12,"div",3)(13,"label",4)(14,"div",5)(15,"span",9),l(16,"Password"),s()(),S(17,"input",10),a(18,"div",5),g(19,Hs,2,1,"span",8),s()()(),a(20,"div",5),g(21,Ys,2,1,"span",8),s(),a(22,"div",11)(23,"button",12),b("click",function(){return r.submitForm()}),l(24," Login "),s()()()),i&2){let o,m;d("formGroup",r.loginForm),c(11),d("ngIf",((o=r.loginForm.get("email"))==null?null:o.invalid)&&(((o=r.loginForm.get("email"))==null?null:o.dirty)||((o=r.loginForm.get("email"))==null?null:o.touched))),c(8),d("ngIf",((m=r.loginForm.get("password"))==null?null:m.invalid)&&(((m=r.loginForm.get("password"))==null?null:m.dirty)||((m=r.loginForm.get("password"))==null?null:m.touched))),c(2),d("ngIf",r.getCommonError().length>0),c(2),d("disabled",r.loginForm.invalid)}},dependencies:[Ee,re,Be,ue,me,de,pe,We,he,fe]})}}return t})();var jr=(()=>{class t{constructor(){this.timeoutSubject=new dn(300),this.timeout$=this.timeoutSubject.asObservable()}startTimer(){localStorage.getItem("bookingStartTime")||(localStorage.setItem("bookingStartTime",Date.now().toString()),localStorage.setItem("totalDuration","100"));let i=this.calculateElapsedTime(),r=Math.max(100-i,0);this.timeoutSubject.next(r),this.timer=setInterval(()=>{let o=this.timeoutSubject.value;o>0?(console.log("currentValue",o),this.timeoutSubject.next(o-1)):this.stopTimer()},1e3)}calculateElapsedTime(){let e=parseInt(localStorage.getItem("bookingStartTime")||"0");return Math.floor((Date.now()-e)/1e3)}stopTimer(){this.timer&&(clearInterval(this.timer),localStorage.removeItem("bookingStartTime"),localStorage.removeItem("totalDuration"))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ur=(()=>{class t{constructor(e){this.http=e}getPassengerByUserId(e){return this.http.get(`${se}/passengers/search`,{params:{user_id:e}})}getPassengerRecentByUserId(e){return this.http.get(`${se}/passengers/recent/${e}}`)}createPassenger(e){return this.http.post(`${se}/passengers`,e)}updatePassenger(e,i){return this.http.patch(`${se}/passengers/${e}`,i)}static{this.\u0275fac=function(i){return new(i||t)(z(Ne))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var sn=t=>({"step-primary":t});function Ks(t,n){if(t&1){let e=V();a(0,"div",5)(1,"button",18),b("click",function(){F(e);let r=p();return D(r.addPassenger())}),l(2," Add Passenger "),s()()}}function Xs(t,n){if(t&1){let e=V();a(0,"button",35),b("click",function(){F(e);let r=p().index,o=p();return D(o.removePassenger(r))}),l(1," Remove "),s()}}function Qs(t,n){t&1&&(a(0,"div")(1,"div",36)(2,"label",37),l(3,"First Name"),s(),S(4,"input",38),s(),a(5,"div",36)(6,"label",37),l(7,"Last Name"),s(),S(8,"input",39),s(),a(9,"div",36)(10,"label",37),l(11,"Date of Birth"),s(),S(12,"input",40),s(),a(13,"div",36)(14,"label",37),l(15,"Gender"),s(),a(16,"select",41)(17,"option",42),l(18,"Male"),s(),a(19,"option",43),l(20,"Female"),s(),a(21,"option",44),l(22,"Other"),s()()()())}function Zs(t,n){t&1&&(a(0,"div")(1,"div",36)(2,"label",37),l(3,"Passport Number"),s(),S(4,"input",45),s(),a(5,"div",36)(6,"label",37),l(7,"Passport Expiry Date"),s(),S(8,"input",46),s(),a(9,"div",36)(10,"label",37),l(11,"Nationality"),s(),S(12,"input",47),s()())}function ea(t,n){t&1&&(a(0,"div")(1,"div",36)(2,"label",37),l(3,"Street Address"),s(),S(4,"input",48),s(),a(5,"div",36)(6,"label",37),l(7,"City"),s(),S(8,"input",49),s(),a(9,"div",36)(10,"label",37),l(11,"Country"),s(),S(12,"input",50),s(),a(13,"div",36)(14,"label",37),l(15,"Postal Code"),s(),S(16,"input",51),s()())}function ta(t,n){if(t&1){let e=V();a(0,"button",52),b("click",function(){F(e);let r=p().index,o=p();return D(o.previousStep(r))}),l(1," Previous "),s()}}function ia(t,n){if(t&1){let e=V();a(0,"button",53),b("click",function(){F(e);let r=p().index,o=p();return D(o.nextStep(r))}),l(1," Next "),s()}if(t&2){let e=p().index,i=p();d("disabled",!i.isCurrentStepValid(e))}}function na(t,n){if(t&1){let e=V();a(0,"button",17),b("click",function(){F(e);let r=p(3);return D(r.openConfirmDialog())}),l(1," Submit "),s()}}function ra(t,n){if(t&1&&g(0,na,2,0,"button",54),t&2){let e=p().index,i=p();d("ngIf",i.currentStep[e]===3)}}function oa(t,n){t&1&&ze(0)}function sa(t,n){if(t&1&&(a(0,"div",19)(1,"ul",20)(2,"li",21),l(3," Personal Information "),s(),a(4,"li",21),l(5," Travel Document "),s(),a(6,"li",21),l(7," Contact Information "),s()(),a(8,"div",22)(9,"div",23)(10,"div",24)(11,"h3",25),l(12),s(),g(13,Xs,2,0,"button",26),s(),g(14,Qs,23,0,"div",27)(15,Zs,13,0,"div",27)(16,ea,17,0,"div",27),a(17,"div",28),g(18,ta,2,0,"button",29)(19,ia,2,1,"button",30)(20,ra,1,1,"button",31),a(21,"dialog",32)(22,"div",33)(23,"h3",15),l(24,"Confirm Booking"),s(),g(25,oa,1,0,"ng-container",34),s()()()()()()),t&2){let e=n.index,i=p(),r=et(15);d("formGroupName",e),c(2),d("ngClass",tt(14,sn,i.currentStep[e]>=1)),c(2),d("ngClass",tt(16,sn,i.currentStep[e]>=2)),c(2),d("ngClass",tt(18,sn,i.currentStep[e]>=3)),c(6),x("Passenger ",e+1,""),c(),d("ngIf",i.passengersFormArray.length>1),c(),d("ngIf",i.currentStep[e]===1),c(),d("ngIf",i.currentStep[e]===2),c(),d("ngIf",i.currentStep[e]===3),c(),d("ngClass",i.currentStep[e]===1?"justify-end":"justify-between"),c(),d("ngIf",i.currentStep[e]>1),c(),d("ngIf",i.currentStep[e]<3),c(),Q(i.isAuth()?20:-1),c(5),d("ngTemplateOutlet",r)}}function aa(t,n){if(t&1){let e=V();a(0,"div",59),b("click",function(){let r=F(e).$implicit,o=p(2);return D(o.selectPassenger(r))}),a(1,"div",23)(2,"h4",25),l(3),s(),a(4,"p"),l(5),s(),a(6,"p"),l(7),s()()()}if(t&2){let e=n.$implicit;c(3),bt(" ",e.first_name," ",e.last_name," "),c(2),x("Passport: ",e.passport_number,""),c(2),x("Nationality: ",e.nationality,"")}}function la(t,n){if(t&1&&(a(0,"div",55)(1,"h3",56),l(2,"Recent Passengers"),s(),a(3,"div",57),g(4,aa,8,4,"div",58),s()()),t&2){let e=p();c(4),d("ngForOf",e.recentPassengers.slice(0,3))}}function ca(t,n){t&1&&ze(0)}function ma(t,n){if(t&1&&(a(0,"div",60)(1,"div",23)(2,"h2",25),l(3,"Already have an account"),s()()(),g(4,ca,1,0,"ng-container",34)),t&2){p();let e=et(26);c(4),d("ngTemplateOutlet",e)}}function da(t,n){if(t&1){let e=V();a(0,"app-register",63),b("isAuthChanged",function(){F(e);let r=p(2);return D(r.routeToBookingFormRegister())}),s()}}function pa(t,n){if(t&1){let e=V();a(0,"app-login",63),b("isAuthChanged",function(){F(e);let r=p(2);return D(r.routeToBookingFormLogin())}),s()}}function ua(t,n){t&1&&ze(0)}function ha(t,n){if(t&1){let e=V();a(0,"div",60)(1,"div",23)(2,"h2",25),l(3,"Account Options"),s(),a(4,"p"),l(5,"Create new account or login to booking"),s(),a(6,"div",61)(7,"a",62),b("click",function(){F(e);let r=p();return D(r.setAuthTab("register"))}),l(8,"Register"),s(),a(9,"a",62),b("click",function(){F(e);let r=p();return D(r.setAuthTab("login"))}),l(10,"Login"),s()(),g(11,da,1,0,"app-register")(12,pa,1,0,"app-login"),s()(),g(13,ua,1,0,"ng-container",34)}if(t&2){let e=p(),i=et(26);c(7),Ai("tab-active",e.activeAuthTab==="register"),c(2),Ai("tab-active",e.activeAuthTab==="login"),c(2),Q(e.activeAuthTab==="register"?11:12),c(2),d("ngTemplateOutlet",i)}}function fa(t,n){if(t&1&&(a(0,"div",64)(1,"span",65),l(2,"error"),s(),a(3,"span"),l(4),s()()),t&2){let e=n.$implicit;c(4),N(e)}}function ga(t,n){if(t&1){let e=V();a(0,"p"),l(1,"Would you like to proceed with this booking?"),s(),a(2,"div",66)(3,"button",17),b("click",function(){F(e);let r=p();return D(r.confirmBooking())}),l(4,"Confirm"),s(),a(5,"button",52),b("click",function(){F(e);let r=p();return D(r.closeDialog())}),l(6,"Cancel"),s()()}}function _a(t,n){t&1&&(a(0,"div",83),S(1,"div",84),s())}function va(t,n){if(t&1&&(a(0,"div",85)(1,"p"),l(2),s(),l(3," \u2022 "),a(4,"p"),l(5," Change planes in "),a(6,"strong"),l(7),s()()()),t&2){let e=p().$index,i=p().$implicit;c(2),N(i.layoverInfo[e].duration),c(5),N(i.layoverInfo[e].layoverAirport)}}function ya(t,n){t&1&&(a(0,"div",83),S(1,"div",84),s())}function xa(t,n){if(t&1&&(a(0,"div",71)(1,"div",72)(2,"span",73),l(3," travel "),s(),a(4,"div",74)(5,"p",75),l(6),s(),S(7,"img",76),s()(),a(8,"div",77)(9,"div",78)(10,"div")(11,"p",75),l(12),s(),a(13,"p",79),l(14),s()()(),a(15,"span",65),l(16," swap_horiz "),s(),a(17,"div",78)(18,"div")(19,"p",75),l(20),s(),a(21,"p",79),l(22),s()()()(),a(23,"div",80)(24,"span",73),l(25," schedule "),s(),a(26,"span"),l(27),s()()(),g(28,_a,2,0,"div",81)(29,va,8,2,"div",82)(30,ya,2,0,"div",81)),t&2){let e=n.$implicit,i=n.$index,r=p().$implicit;c(6),N(e.flightLogoBrandName),c(),d("src",e.flightLogoBrand,Ze),c(5),N(e.departureAirport),c(2),N(e.departureTime),c(6),N(e.arrivalAirport),c(2),N(e.arrivalTime),c(5),x("Duration: ",e.duration,""),c(),d("ngIf",i<r.flightSegmentInfo.length-1),c(),d("ngIf",i<r.flightSegmentInfo.length-1),c(),d("ngIf",i<r.flightSegmentInfo.length-1)}}function ba(t,n){if(t&1&&(a(0,"div",69)(1,"h3",70)(2,"span",65),l(3),s(),l(4),s(),le(5,xa,31,10,null,null,je),s()),t&2){let e=n.$implicit,i=n.$index;c(3),x(" ",i%2===0?"flight_takeoff":"flight_land"," "),c(),bt(" ",i%2===0?"Outbound Flight":"Inbound Flight"," - ",e.headerDate," "),c(),ce(e.flightSegmentInfo)}}function Ca(t,n){if(t&1&&(a(0,"div",67)(1,"div",23)(2,"h2",68)(3,"span",65),l(4," flight "),s(),l(5," Flight Overview "),s(),le(6,ba,7,3,"div",69,_t),s()()),t&2){let e=p();c(6),ce(e.legInfo)}}var qr=(()=>{class t{constructor(e,i,r,o,m,u,h,_){this._fb=e,this.authService=i,this.timerService=r,this.flightServiceAPI=o,this.router=m,this.bookingService=u,this.route=h,this.passengerService=_,this.recentPassengers=[],this.timeRemainingDisplay="",this.currentStep=[1],this.isAuth=ae(!1),this.hasFormChanged=!1,this.dataEmail="",this.user_id=ae(""),this.legInfo=[],this.itinerary_id=ae(""),this.booking_id=ae(0),this.formSubmit$=new ne,this.destroy$=new ne,this.activeAuthTab="register",this.step1Fields=["firstName","lastName","dateOfBirth","gender"],this.step2Fields=["passportNumber","passportExpiry","nationality"],this.step3Fields=["address","city","country","postalCode"],this.toastMessages=[]}ngOnInit(){this.getItineraryID(),this.checkAuthAndInitForm(),this.createBookingPending(),this.formSubmit$.pipe(J(()=>this.bookingForm.markAsDirty()),Z(()=>Ve(this.bookingForm)),De(e=>e),Me(this.destroy$)).subscribe(()=>this.confirmBooking())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.timerService.stopTimer(),localStorage.removeItem("bookingTimer"),window.onbeforeunload=null,this.bookingService.removeBookingPending(this.booking_id())}handleBeforeUnload(e){return console.log("handleBeforeUnload",e),e.preventDefault(),this.bookingService.removeBookingPending(this.booking_id()).subscribe(),!1}createBookingPending(){let e={itinerary_id:this.itinerary_id(),user_id:this.user_id()};this.isAuth()&&this.bookingService.bookingPending(e).pipe(J(i=>{console.log("createBookingPending",i.booking_id),this.booking_id.set(i.booking_id),this.startBookingTimer()})).subscribe()}initEmptyForm(){this.bookingForm=this._fb.group({itineraryId:["",w.required],passengers:this._fb.array([])}),this.initFirstPassenger()}get passengersFormArray(){return this.bookingForm.get("passengers")}addPassenger(){this.bookingService.updateNewPassenger(this.booking_id()).subscribe(e=>{e.status?(this.currentStep.push(1),this.passengersFormArray.push(this.createPassengerForm())):this.showToast("No available seat")})}showToast(e){this.toastMessages.push(e),setTimeout(()=>{this.toastMessages.pop()},3e3)}initFirstPassenger(){this.currentStep.push(1),this.passengersFormArray.push(this.createPassengerForm())}removePassenger(e){this.bookingService.removePassengerBookingPending(this.booking_id()).pipe(J(i=>{console.log("res",i),this.passengersFormArray.removeAt(e),this.currentStep.splice(e,1)})).subscribe()}createPassengerForm(){return this._fb.group({passengerID:["",w.required],firstName:[{value:"",disabled:!this.isAuth()},w.required],lastName:[{value:"",disabled:!this.isAuth()},w.required],gender:[{value:"",disabled:!this.isAuth()},w.required],passportNumber:[{value:"",disabled:!this.isAuth()},w.required],passportExpiry:[{value:"",disabled:!this.isAuth()},w.required],nationality:[{value:"",disabled:!this.isAuth()},w.required],dateOfBirth:[{value:"",disabled:!this.isAuth()},w.required],address:[{value:"",disabled:!this.isAuth()},w.required],city:[{value:"",disabled:!this.isAuth()},w.required],country:[{value:"",disabled:!this.isAuth()},w.required],postalCode:[{value:"",disabled:!this.isAuth()},w.required]})}getItineraryID(){this.route.queryParams.subscribe(e=>{let i=history.state;console.log("state",i),this.legInfo=i.legInfo;let r=e.itineraryId,o=e.token;if(!r&&!o){this.router.navigate(["/"]);return}else this.legInfo||this.flightServiceAPI.searchDetail(r,o).subscribe(m=>{console.log("res",m),m.status?(this.legInfo=m.data.itinerary.legs.map(u=>{let h=u.duration,_=u.departure,{flightSegmentInfo:C,layoverInfo:L}=Wn(u.segments,m.data.itineraryLegacyInfo.carrierLogos[u.segments[0].marketingCarrier.id]),ee=new Array(C.length).fill(!1);return{flightSegmentInfo:C,layoverInfo:L,fullDurationSegment:h,headerDate:_,isDetailSegmentAmenities:ee}}),this.itinerary_id.set(r)):this.router.navigate(["/"]),console.log("legInfo",this.legInfo)});this.itinerary_id.set(e.itineraryId)})}checkAuthAndInitForm(){this.authService.isAuthenticated().pipe(Qe(e=>(this.isAuth.set(e),this.initEmptyForm(),this.bookingForm.get("itineraryId")?.setValue(this.itinerary_id()),e)),Z(e=>e?this.authService.getDataFromAccessToken().pipe(J(i=>{this.user_id.set(i.user_id),this.loadRecentPassengers()})):we(null))).subscribe()}loadRecentPassengers(){this.passengerService.getPassengerRecentByUserId(this.user_id()).pipe(J(e=>{this.recentPassengers=e,e.length>0&&this.initFormWithPassengerData(e[0])})).subscribe()}initFormWithPassengerData(e){let i=this.passengersFormArray.length-1,r=this.passengersFormArray.at(i),o={passengerID:e.passenger_id,firstName:e.first_name,lastName:e.last_name,dateOfBirth:new Date(e.date_of_birth).toISOString().split("T")[0],gender:e.gender,passportNumber:e.passport_number,passportExpiry:e.passport_expiry,nationality:e.nationality,address:e.street_address,city:e.city,country:e.country,postalCode:e.postal_code};r.patchValue(o)}startBookingTimer(){this.timerService.startTimer(),this.timerService.timeout$.subscribe(e=>{this.timeRemainingDisplay=zn(e),e===0&&(console.log("timeout"),this.showTimeoutModal())})}showTimeoutModal(){document.getElementById("timeoutModal").showModal()}selectPassenger(e){this.initFormWithPassengerData(e)}confirmBooking(){let e=this.bookingForm.get("itineraryId")?.value,i=this.passengersFormArray.value.map(r=>({first_name:r.firstName,last_name:r.lastName,gender:r.gender,passport_number:r.passportNumber,passport_expiry:r.passportExpiry,nationality:r.nationality,date_of_birth:r.dateOfBirth,street_address:r.address,city:r.city,country:r.country,postal_code:r.postalCode}));this.proceedWithBooking(e,i)}proceedWithBooking(e,i){this.bookingService.createBooking({booking_id:this.booking_id(),itinerary_id:e,user_id:this.user_id(),passenger_data:i}).subscribe(r=>{r.booking&&r.passenger&&(this.booking=r.booking,this.passenger=r.passenger,this.flightItinerary=r.itinerary,this.closeDialog(),this.redirectToInvoicePage())})}redirectToInvoicePage(){this.router.navigate(["/invoice"],{state:{user_id:this.user_id(),booking:this.booking,passenger:this.passenger,itinerary:this.flightItinerary}})}openConfirmDialog(){document.getElementById("my_modal_1").showModal()}closeDialog(){document.getElementById("my_modal_1").close()}isCurrentStepValid(e){let i=[];switch(this.currentStep[e]){case 1:i=this.step1Fields;break;case 2:i=this.step2Fields;break;case 3:i=this.step3Fields;break}let r=this.bookingForm.get("passengers").at(e);return i.every(o=>{let m=r.get(o);return m&&m.valid})}nextStep(e){if(this.isCurrentStepValid(e))this.currentStep[e]++;else{let i=this.bookingForm.get("passengers").at(e);Object.keys(i.controls).forEach(r=>{i.get(r)?.markAsTouched()})}}previousStep(e){this.currentStep[e]>1&&this.currentStep[e]--}getBackendFieldName(e){return e.replace(/[A-Z]/g,i=>`_${i.toLowerCase()}`)}setAuthTab(e){this.activeAuthTab=e}routeToBookingFormLogin(){console.log("routeToBookingForm Login"),window.location.reload()}routeToBookingFormRegister(){console.log("routeToBookingForm Register"),this.activeAuthTab="login"}redirectToSearch(){this.router.navigate(["/home"]),this.bookingService.removeBookingPending(this.booking_id()).subscribe(()=>{window.location.reload()})}static{this.\u0275fac=function(i){return new(i||t)(T(ge),T(Ge),T(jr),T(It),T(X),T(ai),T(St),T(Ur))}}static{this.\u0275cmp=q({type:t,selectors:[["app-booking-form"]],hostBindings:function(i,r){i&1&&b("beforeunload",function(m){return r.handleBeforeUnload(m)},!1,Cn)},standalone:!0,features:[Se],decls:27,vars:7,consts:[["confirmBookingTemplate",""],["flightItineraryInformation",""],[1,"flex","justify-between","gap-8","px-20","py-10","mx-auto"],[1,"w-2/3"],[3,"formGroup"],[1,"flex","justify-between","mb-4"],["formArrayName","passengers"],[3,"formGroupName",4,"ngFor","ngForOf"],["class","mt-8",4,"ngIf"],[1,"w-1/3"],[1,"timer-display"],["id","no-seat-toast",1,"toast","toast-top","toast-end"],["class","alert alert-error text-white",4,"ngFor","ngForOf"],["id","timeoutModal",1,"modal"],[1,"modal-box"],[1,"font-bold","text-lg"],[1,"modal-action","flex","justify-end"],[1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[3,"formGroupName"],[1,"steps","steps-vertical","lg:steps-horizontal","w-full","mb-8"],[1,"step",3,"ngClass"],[1,"card","bg-base-300","mb-4"],[1,"card-body"],[1,"flex","justify-between"],[1,"card-title"],["type","button","class","btn btn-error",3,"click",4,"ngIf"],[4,"ngIf"],[1,"flex","mt-4",3,"ngClass"],["class","btn",3,"click",4,"ngIf"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-primary"],["id","my_modal_1",1,"modal"],[1,"modal-box","w-5/6","max-w-xl"],[4,"ngTemplateOutlet"],["type","button",1,"btn","btn-error",3,"click"],[1,"form-control"],[1,"label"],["type","text","formControlName","firstName",1,"input","input-bordered"],["type","text","formControlName","lastName",1,"input","input-bordered"],["type","date","formControlName","dateOfBirth",1,"input","input-bordered"],["formControlName","gender",1,"select","select-bordered"],["value","male"],["value","female"],["value","other"],["type","text","formControlName","passportNumber",1,"input","input-bordered"],["type","date","formControlName","passportExpiry",1,"input","input-bordered"],["type","text","formControlName","nationality",1,"input","input-bordered"],["type","text","formControlName","address",1,"input","input-bordered"],["type","text","formControlName","city",1,"input","input-bordered"],["type","text","formControlName","country",1,"input","input-bordered"],["type","text","formControlName","postalCode",1,"input","input-bordered"],[1,"btn",3,"click"],[1,"btn","btn-primary",3,"click","disabled"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"mt-8"],[1,"text-lg","font-bold","mb-4"],[1,"grid","grid-cols-3","gap-4"],["class","card bg-base-200 cursor-pointer hover:bg-base-300",3,"click",4,"ngFor","ngForOf"],[1,"card","bg-base-200","cursor-pointer","hover:bg-base-300",3,"click"],[1,"card","bg-base-200"],[1,"tabs","tabs-boxed"],[1,"tab",3,"click"],[3,"isAuthChanged"],[1,"alert","alert-error","text-white"],[1,"material-symbols-outlined"],[1,"modal-action"],[1,"card","bg-base-200","mt-4"],[1,"card-title","flex","items-center"],[1,"mb-6","border-l-4","border-primary","pl-4"],[1,"text-lg","font-bold","mb-3","flex","items-center"],[1,"segment","my-4"],[1,"flex","items-center","my-2"],[1,"material-symbols-outlined","pr-2"],[1,"flex","items-center"],[1,"font-bold"],["alt","Airline Logo",1,"h-4","ml-2",3,"src"],[1,"flex","items-center","justify-between"],[1,"flex","flex-col","w-32"],[1,"text-sm"],[1,"mt-2","flex","items-center"],["class","flex w-full justify-center items-center my-2",4,"ngIf"],["class","flex flex-row gap-2 whitespace-nowrap px-4",4,"ngIf"],[1,"flex","w-full","justify-center","items-center","my-2"],[1,"w-full","h-0.5","bg-slate-300"],[1,"flex","flex-row","gap-2","whitespace-nowrap","px-4"]],template:function(i,r){if(i&1){let o=V();a(0,"div",2)(1,"div",3)(2,"form",4),g(3,Ks,3,0,"div",5),a(4,"div",6),g(5,sa,26,20,"div",7),s()(),g(6,la,5,1,"div",8),s(),a(7,"div",9)(8,"div",10),l(9),s(),g(10,ma,5,1)(11,ha,14,6),s()(),a(12,"div",11),g(13,fa,5,1,"div",12),s(),g(14,ga,7,0,"ng-template",null,0,ct),a(16,"dialog",13)(17,"div",14)(18,"h3",15),l(19,"Session Timeout"),s(),a(20,"p"),l(21," Your booking session has expired. Please search again for fresh flight data. "),s(),a(22,"div",16)(23,"button",17),b("click",function(){return F(o),D(r.redirectToSearch())}),l(24," Return to Search "),s()()()(),g(25,Ca,8,0,"ng-template",null,1,ct)}i&2&&(c(2),d("formGroup",r.bookingForm),c(),Q(r.isAuth()?3:-1),c(2),d("ngForOf",r.passengersFormArray.controls),c(),d("ngIf",r.isAuth()&&r.recentPassengers.length>0),c(3),x("Time remaining: ",r.timeRemainingDisplay,""),c(),Q(r.isAuth()?10:11),c(3),d("ngForOf",r.toastMessages))},dependencies:[Ee,mt,Pe,re,si,Be,ue,Tt,Et,me,kt,de,pe,he,fe,jn,Un,$t,Bt]})}}return t})();var Hr=(()=>{class t{constructor(e){this.router=e}routeToHome(){this.router.navigate(["/home"])}static{this.\u0275fac=function(i){return new(i||t)(T(X))}}static{this.\u0275cmp=q({type:t,selectors:[["app-login-page"]],decls:2,vars:0,consts:[[1,"container","w-full","h-screen","flex","mx-auto","justify-center","items-center"],[3,"isAuthChanged"]],template:function(i,r){i&1&&(a(0,"div",0)(1,"app-login",1),b("isAuthChanged",function(){return r.routeToHome()}),s()())},dependencies:[$t]})}}return t})();var an=(()=>{class t{constructor(e,i,r){this.authService=e,this.router=i,this.tokenService=r}canActivate(){return this.authService.isAuthenticated().pipe(Qe(e=>e),Z(e=>(console.log("isAccessTokenValid",e),e?this.authService.isRefreshTokenExpired().pipe(Z(i=>(console.log("isExpired",i),i?we(!0):this.authService.refreshToken().pipe(Qe(r=>(this.tokenService.setAccessToken(r.accessToken),this.router.navigate(["/home"]),!1)))))):we(!0))))}static{this.\u0275fac=function(i){return new(i||t)(z(Ge),z(X),z($e))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Yr=(()=>{class t{constructor(){}transform(e,i="yyyy-MM-dd HH:mm"){let r=localStorage.getItem("userTimezone")||Intl.DateTimeFormat().resolvedOptions().timeZone;return Yn(new Date(e),r,i)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=oi({name:"userTimezone",type:t,pure:!0,standalone:!0})}}return t})();var zr=(()=>{class t{transform(e){return e?e.substring(0,16).replace("T"," "):""}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=oi({name:"mediumDate",type:t,pure:!0,standalone:!0})}}return t})();function wa(t,n){if(t&1&&(l(0),ke(1,"mediumDate")),t&2){let e=p().$implicit;x(" ",Te(1,1,e.depature_time)," ")}}function Sa(t,n){if(t&1&&(l(0),ke(1,"userTimezone")),t&2){let e=p().$implicit;x(" ",Te(1,1,e.depature_time)," ")}}function ka(t,n){if(t&1&&(l(0),ke(1,"mediumDate")),t&2){let e=p().$implicit;x(" ",Te(1,1,e.arrival_time)," ")}}function Ta(t,n){if(t&1&&(l(0),ke(1,"userTimezone")),t&2){let e=p().$implicit;x(" ",Te(1,1,e.arrival_time)," ")}}function Ea(t,n){if(t&1&&(a(0,"div",31)(1,"div",33),S(2,"img",34),a(3,"div")(4,"p",9),l(5),s(),a(6,"p",3),l(7),s()()(),a(8,"div",35)(9,"div")(10,"p",3),l(11,"Departure"),s(),a(12,"p",9),l(13),s(),a(14,"p"),g(15,wa,2,3)(16,Sa,2,3),s()(),a(17,"div",36),S(18,"i",37),a(19,"p",38),l(20),ke(21,"durationFormat"),s()(),a(22,"div")(23,"p",3),l(24,"Arrival"),s(),a(25,"p",9),l(26),s(),a(27,"p"),g(28,ka,2,3)(29,Ta,2,3),s()()()()),t&2){let e=n.$implicit,i=p(2);c(2),d("src",e.aircraft.logoUrl,Ze)("alt",e.aircraft.name),c(3),N(e.aircraft.name),c(2),x("Flight ",e.flight_number,""),c(6),N(e.origin_name),c(2),Q(i.isInvoiceEmail()?15:16),c(5),x(" ",Te(21,9,e.duration_in_minutes)," "),c(6),N(e.destination_name),c(2),Q(i.isInvoiceEmail()?28:29)}}function Ia(t,n){if(t&1&&(a(0,"div",32),S(1,"i",39),a(2,"p"),l(3),s()()),t&2){let e=p().$implicit,i=p();c(3),x(" Layover: ",i.calculateLayover(e.segments[0],e.segments[1])," ")}}function Fa(t,n){if(t&1&&(a(0,"div",11)(1,"div",28)(2,"span",23),l(3," flight_takeoff "),s(),a(4,"h3",29),l(5),s()(),a(6,"div",30)(7,"div")(8,"p",3),l(9,"From"),s(),a(10,"p",9),l(11),s()(),a(12,"div")(13,"p",3),l(14,"To"),s(),a(15,"p",9),l(16),s()(),a(17,"div")(18,"p",3),l(19,"Duration"),s(),a(20,"p",9),l(21),ke(22,"durationFormat"),s()(),a(23,"div")(24,"p",3),l(25,"Stops"),s(),a(26,"p",9),l(27),s()()(),le(28,Ea,30,11,"div",31,_t),g(30,Ia,4,1,"div",32),s()),t&2){let e=n.$implicit,i=n.$index,r=n.$count;c(5),x(" ",i===0?"Outbound Flight":"Return Flight"," "),c(6),bt(" ",e.origin_name," (",e.origin_iata,") "),c(5),bt(" ",e.destination_name," (",e.destination_iata,") "),c(5),x(" ",Te(22,8,e.duration_in_minutes)," "),c(6),x("",e.stop_count," stop(s)"),c(),ce(e.segments),c(2),Q(e.stop_count>0&&i!==r-1?30:-1)}}function Da(t,n){if(t&1&&(a(0,"tr")(1,"td",19),l(2),s(),a(3,"td",19),l(4),s(),a(5,"td",19),l(6),s()()),t&2){let e=n.$implicit;c(2),x(" ",e.name," "),c(2),x(" ",e.type," "),c(2),x(" ",e.seat," ")}}function Ma(t,n){if(t&1&&l(0),t&2){let e=p();x(" ",e.bookingInfo==null?null:e.bookingInfo.date," ")}}function Aa(t,n){if(t&1&&(l(0),ke(1,"userTimezone")),t&2){let e=p();x(" ",Te(1,1,e.bookingInfo==null?null:e.bookingInfo.date)," ")}}var wi=(()=>{class t{constructor(e,i,r){this.route=e,this.router=i,this.bookingService=r,this.isInvoiceEmail=ae(!1),this.invoiceNumber="INV-2024-001"}ngOnInit(){this.route.queryParams.subscribe(e=>{if(e.booking_id){let i=e.booking_id;this.bookingService.getBookingById(i).subscribe(r=>{console.log(r),this.booking=r,this.flightItinerary=r.itinerary,this.passengers=r.passengers,this.isInvoiceEmail.set(!0),this.setInvoice()})}else{let i=history.state;console.log(i),this.flightItinerary=i.itinerary,this.booking=i.booking,this.passengers=i.passenger,this.isInvoiceEmail.set(!1),this.setInvoice()}})}setInvoice(){console.log("booking: ",this.booking),console.log("itinerary: ",this.flightItinerary),console.log("passenger: ",this.passengers),this.flightInfo={departure:this.flightItinerary.legs[0].origin_name,arrival:this.flightItinerary.legs[0].destination_name,date:Ni(this.flightItinerary.legs[0].departure_time)+" "+Pi(this.flightItinerary.legs[0].departure_time),flightNumber:this.flightItinerary.legs[0].segments[0].flight_number},this.passengersInfo=this.passengers.map(e=>({name:e.first_name+" "+e.last_name,type:"Adult",seat:"12A"})),this.bookingInfo={reference:"#"+this.booking.booking_id,date:Ni(this.booking.booking_date)+" "+Pi(this.booking.booking_date),status:this.booking.status},this.contactInfo={email:this.booking.user.email,phone:this.booking.user.phone_number}}calculateLayover(e,i){let r=new Date(e.arrival_time),o=new Date(i.depature_time);return Math.floor((o.getTime()-r.getTime())/(1e3*60))}downloadInvoice(){}printInvoice(){window.print()}static{this.\u0275fac=function(i){return new(i||t)(T(St),T(X),T(ai))}}static{this.\u0275cmp=q({type:t,selectors:[["app-invoice"]],standalone:!0,features:[Se],decls:101,vars:10,consts:[[1,"container","mx-auto","p-8","bg-base-100"],[1,"text-center","mb-8"],[1,"text-3xl","font-bold"],[1,"text-sm"],[1,"card","bg-base-200","shadow-xl","mb-6"],[1,"card-body"],[1,"card-title","text-primary","mb-4"],[1,"bg-base-100","p-4","rounded-lg","mb-6"],[1,"flex","justify-between","items-center"],[1,"font-bold"],[1,"badge","badge-success","text-white"],[1,"mb-8"],[1,"card-title","text-primary"],[1,"overflow-x-auto"],[1,"table"],[1,"font-medium"],[4,"ngFor","ngForOf"],[1,"grid","grid-cols-2","gap-4"],[1,"font-normal"],[1,"text-lg","text-neutral-950","font-bold"],[1,"badge","badge-success","badge-lg","text-white"],[1,"space-y-2"],[1,"alert","alert-info"],[1,"material-symbols-outlined"],[1,"alert","alert-warning"],[1,"flex","justify-end","gap-4"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline",3,"click"],[1,"flex","items-center","mb-4","gap-2"],[1,"font-bold","text-lg"],[1,"grid","grid-cols-2","gap-4","bg-base-100","p-4","rounded-lg","mb-4"],[1,"border-l-4","border-primary","pl-4","mb-4"],[1,"flex","items-center","justify-center","bg-base-300","p-2","rounded-lg","mb-4"],[1,"flex","items-center","mb-2"],[1,"h-8","w-8","mr-2",3,"src","alt"],[1,"grid","grid-cols-3","gap-4","bg-base-100","p-3","rounded-lg"],[1,"flex","items-center","justify-center"],[1,"fas","fa-arrow-right"],[1,"text-sm","ml-2"],[1,"fas","fa-clock","mr-2"]],template:function(i,r){i&1&&(a(0,"div",0)(1,"div",1)(2,"h1",2),l(3,"Flight Booking Invoice"),s(),a(4,"p",3),l(5),s()(),a(6,"div",4)(7,"div",5)(8,"h2",6),l(9,"Flight Itinerary Details"),s(),a(10,"div",7)(11,"div",8)(12,"div")(13,"p",3),l(14,"Booking Reference"),s(),a(15,"p",9),l(16),s()(),a(17,"div")(18,"p",3),l(19,"Total Price"),s(),a(20,"p",9),l(21),s()(),a(22,"div")(23,"p",3),l(24,"Status"),s(),a(25,"span",10),l(26),s()()()(),le(27,Fa,31,10,"div",11,_t),s()(),a(29,"div",4)(30,"div",5)(31,"h2",12),l(32,"Passenger Information"),s(),a(33,"div",13)(34,"table",14)(35,"thead")(36,"tr")(37,"th",15),l(38,"Name"),s(),a(39,"th",15),l(40,"Type"),s(),a(41,"th",15),l(42,"Seat"),s()()(),a(43,"tbody"),g(44,Da,7,3,"tr",16),s()()()()(),a(45,"div",4)(46,"div",5)(47,"h2",12),l(48,"Booking Information"),s(),a(49,"div",17)(50,"div")(51,"p",18),l(52,"Booking Reference:"),s(),a(53,"p",19),l(54),s()(),a(55,"div")(56,"p",18),l(57,"Booking Date:"),s(),a(58,"p",19),g(59,Ma,1,1)(60,Aa,2,3),s()(),a(61,"div")(62,"p",18),l(63,"Payment Status:"),s(),a(64,"div",20),l(65),s()()()()(),a(66,"div",4)(67,"div",5)(68,"h2",12),l(69,"Contact Information"),s(),a(70,"div",17)(71,"div")(72,"p",18),l(73,"Email:"),s(),a(74,"p",19),l(75),s()(),a(76,"div")(77,"p",18),l(78,"Phone:"),s(),a(79,"p",19),l(80),s()()()()(),a(81,"div",4)(82,"div",5)(83,"h2",12),l(84,"Additional Information"),s(),a(85,"div",21)(86,"div",22)(87,"span",23),l(88," info "),s(),a(89,"span"),l(90,"Check-in opens 24 hours before departure"),s()(),a(91,"div",24)(92,"span",23),l(93," warning "),s(),a(94,"span"),l(95,"Please arrive at the airport at least 2 hours before departure"),s()()()()(),a(96,"div",25)(97,"button",26),b("click",function(){return r.downloadInvoice()}),l(98," Download Invoice "),s(),a(99,"button",27),b("click",function(){return r.printInvoice()}),l(100,"Print"),s()()()),i&2&&(c(5),x("Invoice #",r.invoiceNumber,""),c(11),x(" ",r.booking==null?null:r.booking.booking_id," "),c(5),x("$",r.flightItinerary==null?null:r.flightItinerary.formatted_price,""),c(5),N(r.booking==null?null:r.booking.status),c(),ce(r.flightItinerary==null?null:r.flightItinerary.legs),c(17),d("ngForOf",r.passengersInfo),c(10),x(" ",r.bookingInfo==null?null:r.bookingInfo.reference," "),c(5),Q(r.isInvoiceEmail()?59:60),c(6),x(" ",r.bookingInfo==null?null:r.bookingInfo.status," "),c(10),x(" ",r.contactInfo==null?null:r.contactInfo.email," "),c(5),x(" ",r.contactInfo==null?null:r.contactInfo.phone," "))},dependencies:[Ee,Pe,Yr,Gn,zr]})}}return t})();var Wr=(()=>{class t{constructor(e){this.router=e}routeToLogin(){this.router.navigate(["/login"])}static{this.\u0275fac=function(i){return new(i||t)(T(X))}}static{this.\u0275cmp=q({type:t,selectors:[["app-register-page"]],decls:2,vars:0,consts:[[1,"container","w-full","h-screen","flex","mx-auto","justify-center","items-center"],[3,"isAuthChanged"]],template:function(i,r){i&1&&(a(0,"div",0)(1,"app-register",1),b("isAuthChanged",function(){return r.routeToLogin()}),s()())},dependencies:[Bt]})}}return t})();var Ra=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:bi},{path:"flight",loadChildren:()=>import("./chunk-TJCOEUQI.js").then(t=>t.FlightModule)},{path:"account",loadChildren:()=>import("./chunk-N6IAGG5V.js").then(t=>t.AccountModule)},{path:"booking",component:qr},{path:"invoice",component:wi},{path:"login",component:Hr,canActivate:[an]},{path:"register",component:Wr,canActivate:[an]},{path:"password-reset",component:Nr},{path:"email-reset-password",component:$r},{path:"**",component:Vr}],Gr=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=ri({type:t})}static{this.\u0275inj=ni({imports:[Lt.forRoot(Ra),Lt]})}}return t})();var Jr=(()=>{class t{constructor(){this.keywordTTL=new Map([["auto-complete",60*60*1e3],["search/one-way",5*60*1e3],["search/round-trip",5*60*1e3],["detail",5*60*1e3],["flightsItinerary",5*60*1e3],["flights/search/price",5*60*1e3]]),this.#e=new Map}#e;getRandomizedTTL(e){let i=e*.1,r=Math.random()*i*2-i;return e+r}get(e){let i=this.#e.get(e);if(!i)return;if(new Date().getTime()>=i.expiresOn){this.#e.delete(e);return}return i.data}set(e,i){for(let[r,o]of this.keywordTTL)if(e.includes(r)){let m=this.getRandomizedTTL(o);this.#e.set(e,{data:i,expiresOn:new Date().getTime()+m});return}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Kr=(()=>{class t{constructor(e){this.caching=e}intercept(e,i){if(e.method!=="GET")return i.handle(e);let r=this.caching.get(e.urlWithParams);return r instanceof Oi?(console.log("Serving from cache:",e.urlWithParams),we(r)):i.handle(e).pipe(J(o=>{o instanceof Oi&&(console.log("Caching response for:",e.urlWithParams),this.caching.set(e.urlWithParams,o))}),vn(1))}static{this.\u0275fac=function(i){return new(i||t)(z(Jr))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac})}}return t})();var Xr=(()=>{class t{constructor(){}intercept(e,i){return i.handle(e).pipe(_n(1),Le(r=>(console.error("Request failed after 2 attempts:",r),yt(()=>r))))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac})}}return t})();var Qr=(()=>{class t{constructor(e){this.tokenService=e,this.protectedPaths=["/auto-complete","/users/search","bookings","users/timezone"]}intercept(e,i){if(this.protectedPaths.some(o=>e.url.includes(o))){let o=this.tokenService.getAccessToken();e=e.clone({headers:e.headers.set("Authorization",`Bearer ${o}`)})}return i.handle(e)}static{this.\u0275fac=function(i){return new(i||t)(z($e))}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac})}}return t})();var ln=ii(en());function Pa(t,n){if(t&1&&(a(0,"div",9),l(1),s()),t&2){let e=n.$implicit;c(),N(e)}}function Na(t,n){t&1&&S(0,"div")}function Ba(t,n){if(t&1&&le(0,Na,1,0,"div",null,je),t&2){let e=p(2);ce(e.calendarMonths[e.currentMonthIndex].prevMonthDays)}}function $a(t,n){if(t&1&&(a(0,"span",15),l(1),s()),t&2){let e=p().$implicit,i=p(2);c(),N(i.formatPrice(e.price))}}function Va(t,n){if(t&1){let e=V();a(0,"button",12),b("click",function(){let r=F(e).$implicit,o=p(2);return D(o.getPriceDate(r.day))})("mouseenter",function(){let r=F(e).$implicit,o=p(2);return D(o.onDateHover(r.day))})("mouseleave",function(){F(e);let r=p(2);return D(r.hoveredDate=null)}),a(1,"div",13)(2,"span",14),l(3),s(),g(4,$a,2,1,"span",15),s()()}if(t&2){let e=n.$implicit,i=p(2);d("ngClass",i.isInRange(e.day)?"bg-blue-100":i.isChosenDate(e.day)?"bg-blue-500 text-white":i.getPriceColorClass(e.group,e.day)),c(2),d("ngClass",i.isPastDate(e.day)?"text-gray-400":e.price==0?"text-black":"text-white"),c(),N(i.formatDate(e.day)),c(),Q(!i.isPastDate(e.day)&&e.price!==0?4:-1)}}function La(t,n){if(t&1&&(a(0,"div",9),l(1),s()),t&2){let e=n.$implicit;c(),N(e)}}function ja(t,n){t&1&&S(0,"div")}function Ua(t,n){if(t&1&&le(0,ja,1,0,"div",null,je),t&2){let e=p(2);ce(e.calendarMonths[e.currentMonthIndex+1].prevMonthDays)}}function qa(t,n){if(t&1&&(a(0,"span",15),l(1),s()),t&2){let e=p().$implicit,i=p(2);c(),N(i.formatPrice(e.price))}}function Ha(t,n){if(t&1){let e=V();a(0,"button",12),b("click",function(){let r=F(e).$implicit,o=p(2);return D(o.getPriceDate(r.day))})("mouseenter",function(){let r=F(e).$implicit,o=p(2);return D(o.onDateHover(r.day))})("mouseleave",function(){F(e);let r=p(2);return D(r.hoveredDate=null)}),a(1,"div",13)(2,"span",14),l(3),s(),g(4,qa,2,1,"span",15),s()()}if(t&2){let e=n.$implicit,i=p(2);d("ngClass",i.isInRange(e.day)?"bg-blue-100 text-black":i.isChosenDate(e.day)?"bg-blue-500 text-white":i.getPriceColorClass(e.group,e.day)),c(2),d("ngClass",i.isPastDate(e.day)?"text-gray-400":e.price==0?"text-black":"text-white"),c(),N(i.formatDate(e.day)),c(),Q(!i.isPastDate(e.day)&&e.price!==0?4:-1)}}function Ya(t,n){if(t&1){let e=V();a(0,"div")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"button",6),b("click",function(){F(e);let r=p();return D(r.navigatePrev())}),a(7,"span",7),l(8,"chevron_left"),s()(),l(9),S(10,"div"),s(),a(11,"div",8),le(12,Pa,2,1,"div",9,_t),s(),a(14,"div",10),g(15,Ba,2,0),le(16,Va,5,4,"button",11,je),s()(),a(18,"div",4)(19,"div",5),S(20,"div"),l(21),a(22,"button",6),b("click",function(){F(e);let r=p();return D(r.navigateNext())}),a(23,"span",7),l(24,"chevron_right"),s()()(),a(25,"div",8),le(26,La,2,1,"div",9,je),s(),a(28,"div",10),g(29,Ua,2,0),le(30,Ha,5,4,"button",11,je),s()()()()()()}if(t&2){let e=p();Sn(e.isCalendarOpen()?"block":"hidden"),c(9),x(" ",e.formatMonthYear(e.calendarMonths[e.currentMonthIndex].monthYear)," "),c(3),ce(e.weekDays),c(3),Q(e.calendarMonths[e.currentMonthIndex].prevMonthDays.length!==0?15:-1),c(),ce(e.calendarMonths[e.currentMonthIndex].days),c(5),x(" ",e.formatMonthYear(e.calendarMonths[e.currentMonthIndex+1].monthYear)," "),c(5),ce(e.weekDays),c(3),Q(e.calendarMonths[e.currentMonthIndex+1].prevMonthDays.length!==0?29:-1),c(),ce(e.calendarMonths[e.currentMonthIndex+1].days)}}var Si=(()=>{class t{constructor(e){this.calendarService=e,this.isCalendarOpen=xt.required(),this.selectedFlightType=xt.required(),this.DepDesCalendar=xt.required(),this.priceDay=lt(),this.isLoad=ae(!0),this.weekDays=["Sun","Mon","Tue","Wed","Thur","Fri","Sat"],this.currentMonthDays=[],this.nextMonthDays=[],this.calendarMonths=[],this.currentMonthIndex=0,this.hoveredDate=null,this.startDate=ae(""),this.endDate=ae(""),this.initCalendar(),Dn(()=>{if(this.DepDesCalendar()?.from&&this.DepDesCalendar()?.to){let i=new Date,r=this.DepDesCalendar()?.from,o=i.toISOString().split("T")[0],m=this.DepDesCalendar()?.to,u=new Date(i.getFullYear(),i.getMonth()+10,0).toISOString().split("T")[0];this.getPriceCalendar(r,o,m,u)}},{allowSignalWrites:!0})}initCalendar(){let e=new Date;this.calendarMonths=this.calendarService.generateCalendarRange(new Date(e.getFullYear(),e.getMonth()+2,0).toISOString()),this.isLoad.set(!1)}getPriceCalendar(e,i,r,o){pn({oneWay:this.calendarService.searchCalenderPrice(e,i,r),roundTrip:this.calendarService.searchCalenderPriceReturn(e,i,r,o)}).subscribe(({oneWay:m,roundTrip:u})=>{this.selectedFlightType()==="roundTrip"?this.updateCalendar(u):this.updateCalendar(m)}),this.isLoad.set(!1)}updateCalendar(e){let i=e.data.flights.days,r=i[i.length-1].day;this.calendarMonths=this.calendarService.generateCalendarRange(r),this.calendarMonths=this.calendarService.mergePriceData(this.calendarMonths,i)}getPriceColorClass(e,i){return this.isPastDate(i)?"text-gray-400":{high:"bg-red-500 text-white",medium:"bg-yellow-500 text-white",low:"bg-green-500 text-white",init:"bg-gray-200 text-black"}[e]||"bg-gray-200"}isPastDate(e){return new Date(e)<new Date(new Date().setHours(0,0,0,0))}getPriceDate(e){if(this.selectedFlightType()==="roundTrip"){let i=new Date(e);!this.startDate()||this.startDate()&&this.endDate()?(this.startDate.set(e),this.endDate.set(""),console.log("date 1",this.startDate(),this.endDate())):(i<new Date(this.startDate())?(this.endDate.set(this.startDate()),this.startDate.set(e)):this.endDate.set(e),console.log("date 2",this.startDate(),this.endDate()),this.priceDay.emit({departure:this.startDate(),return:this.endDate()}))}else this.priceDay.emit({departure:e,return:""})}onDateHover(e){this.selectedFlightType()==="roundTrip"&&this.startDate()&&!this.endDate()&&(this.hoveredDate=e,console.log("hoverDate",this.hoveredDate))}isInRange(e){let i=new Date(e);if(this.startDate()&&this.endDate()){let m=new Date(this.startDate()),u=new Date(this.endDate());return i>m&&i<u}if(!this.startDate()||!this.hoveredDate)return!1;let r=new Date(this.startDate()),o=new Date(this.hoveredDate);return o<r?i>=o&&i<r:i>r&&i<=o}isChosenDate(e){return e===this.startDate()||e===this.endDate()}formatPrice(e){return`$${e.toFixed(2)}`}get currentMonth(){return this.calendarMonths[this.currentMonthIndex]}get nextMonth(){return this.calendarMonths[this.currentMonthIndex+1]}navigateNext(){this.currentMonthIndex<this.calendarMonths.length-2&&this.currentMonthIndex++}navigatePrev(){this.currentMonthIndex>0&&this.currentMonthIndex--}formatDate(e){return(0,ln.default)(e).format("D")}formatMonthYear(e){let i=(0,ln.default)(e);return`${i.format("YYYY")} ${i.format("MMM")}`}static{this.\u0275fac=function(i){return new(i||t)(T(Pt))}}static{this.\u0275cmp=q({type:t,selectors:[["app-calendar"]],inputs:{isCalendarOpen:[1,"isCalendarOpen"],selectedFlightType:[1,"selectedFlightType"],DepDesCalendar:[1,"DepDesCalendar"]},outputs:{priceDay:"priceDay"},standalone:!0,features:[Se],decls:1,vars:1,consts:[[3,"class"],[1,"absolute","rounded-lg","z-20","flex","flex-row","gap-4","items-center","p-4","w-max","bg-white","shadow-[5px_10px_10px_#dedfe2]"],[1,"w-full"],[1,"flex","gap-4"],[1,"calendar-block","flex","flex-col","justify-start","items-center"],[1,"w-full","font-semibold","flex","justify-between"],["type","button",1,"cursor-pointer","bg-transparent","border-none","hover:scale-110","transition-transform","duration-300",3,"click"],[1,"material-symbols-outlined"],[1,"grid","grid-cols-7","w-full"],[1,"flex-1","text-base","p-2","text-center"],[1,"grid","grid-cols-7","gap-1"],["type","button",1,"rounded-lg","transition-colors","duration-200","text-black",3,"ngClass"],["type","button",1,"rounded-lg","transition-colors","duration-200","text-black",3,"click","mouseenter","mouseleave","ngClass"],[1,"flex","flex-col","flex-wrap","items-center","justify-center","h-12","w-12","hover:opacity-80"],[3,"ngClass"],[1,"text-xs"]],template:function(i,r){i&1&&g(0,Ya,32,7,"div",0),i&2&&Q(r.isLoad()?-1:0)},dependencies:[Ee,mt],styles:['.calendar-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative}.calendar-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:after{content:"";position:absolute;inset:0;transition:background-color .2s ease;pointer-events:none}.calendar-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:after{background-color:#3b82f61a}']})}}return t})();var Zr=(()=>{class t{constructor(e){this.elementRef=e,this.clickOutside=new xn}onClick(e){this.elementRef.nativeElement.contains(e)||this.clickOutside.emit()}static{this.\u0275fac=function(i){return new(i||t)(T(bn))}}static{this.\u0275dir=yn({type:t,selectors:[["","clickOutside",""]],hostBindings:function(i,r){i&1&&b("click",function(m){return r.onClick(m.target)},!1,wn)},outputs:{clickOutside:"clickOutside"},standalone:!0})}}return t})();var eo=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=ri({type:t,bootstrap:[Fr]})}static{this.\u0275inj=ni({providers:[dt,It,Pt,ci,yi,{provide:wt,useClass:Br,multi:!0},{provide:wt,useClass:Qr,multi:!0},{provide:wt,useClass:Lr,multi:!0},{provide:wt,useClass:Kr,multi:!0},{provide:wt,useClass:Xr,multi:!0},Pn(Nn())],imports:[qn,$n,Gr,Be,Lt,$t,Bt,wi,Si,xi,li]})}}return t})();In(bi,[ue,Tt,Et,me,kt,de,pe,We,mt,Pe,re,si,Ln,he,fe,On,Si,Zr],[Jn]);Bn().bootstrapModule(eo).catch(t=>console.error(t));
